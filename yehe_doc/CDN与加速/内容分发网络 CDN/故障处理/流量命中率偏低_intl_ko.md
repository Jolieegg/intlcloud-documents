## 현상 설명

실시간 모니터링에서 트래픽 히트율의 값이 낮고 기대에 미치지 못합니다.

## 가능한 원인

- 캐시 제거: 
  캐시 제거는 노드에서 지정된 콘텐츠를 지우기 때문에 짧은 시간 동안 히트율이 감소 현상이 나타납니다.
- 원본 서버에 신규 리소스 존재
  원본 서버에 새로운 리소스가 비교적 많을 경우, CDN 노드 Origin-pull이 발생하여 트래픽 히트율이 감소합니다.
- 원본 서버 장애
  원본 서버가 장애가 발생하여 5XX 또는 4XX가 비교적 많을 경우, 트래픽 히트율에 영향을 미칠 수 있습니다.
- 잘못된 캐시 정책 설정
  실제 비즈니스 상황에 따라 캐시 규칙을 설정하십시오.
- 샤드 Origin-pull 비활성화
  샤드 Origin-pull을 비활성화 할 경우, 요청에 따른 샤드 풀링이 아닌 전체 대용량 파일을 풀링하게 되어 Origin-pull 트래픽이 증가하고 트래픽 히트율에 영향을 미칩니다.
-도메인 설정의 캐시 키 규칙(모든 매개변수 무시)이 히트되었습니다. 하지만 원본 서버 리소스는 매개변수에 따라 다릅니다.
  원본 서버 리소스는 매개변수에 따라 달라지나, CDN은 모든 매개변수를 무시한 상태로 캐싱을 진행합니다. 다른 매개변수의 리소스 요청 시, 해당 리소스를 매칭할 수 없어 트래픽 히트율에 영향을 미칩니다.

## 해결 방법

1. 원본 서버를 점검하여 원본 서버에 이상이 없는지 확인합니다.
2. 캐시 퍼지를 실행했거나 원본 서버에 새로운 리소스가 많은 경우 이는 정상적인 현상입니다.
3. 원본 서버에서 URL 매개변수에 따라 다른 리소스와 CDN 도메인 설정의 캐시 키 규칙을 내보내기 하는지 확인합니다. - 전체 매개변수를 무시하고 동시에 사용하지 않습니다.
4. 실제 비즈니스 상황에 따라 캐시 규칙을 설정하십시오.

## 처리 순서
[](id:step1)
1. 원본 서버 비정상 여부 또는 캐시 퍼지 실행 여부 확인합니다.
   - 해당 문제가 맞는 경우, 히트율 감소는 정상적인 현상입니다.
   - 해당 문제가 아닌 경우, [2단계](#step2)를 실행합니다.
[](id:step2)
2. 사용자의 비즈니스 상황에 근거하여, 원본 서버에서 URL 매개변수에 따라 각각 다른 리소스를 내보내고 있는지 확인합니다.
   - 해당 문제가 맞는 경우, [3단계](#step3)를 실행합니다.
   - 해당 문제가 아닌 경우, [5단계](#step5)를 실행합니다.
[](id:step3)
3. [CDN 콘솔](https://console.cloud.tencent.com/cdn)에 로그인한 후, [도메인 이름 관리]를 선택해 해당 도메인 설정을 찾습니다. [캐시 설정]>[캐시 키 규칙 설정]의 '매개변수 무시' 항목을 살펴봅니다.CDN 설정 도메인의 매개변수 무시 기능 활성화 여부를 확인합니다.
![img](https://main.qcloudimg.com/raw/53ceba436ae110bd0dafef8bad72ceff.png)
   - 해당 문제가 맞는 경우, [4단계](#step4)를 실행합니다.
   - 해당 문제가 아닌 경우, [5단계](#step5)를 실행합니다.
[](id:step4)
4. 캐시 키 규칙 설정의 해당 규칙 작업 열에서 [수정]을 클릭하고, 팝업되는 '규칙 수정' 창에서 매개변수 무시 기능을 비활성화한 후 [저장]을 클릭합니다.
![img](https://main.qcloudimg.com/raw/f866bc80c384bc6daca649dbeb006fdb.png)
> ?전체 비활성화가 용이하지 않은 경우, CDN은 지정된 매개변수는 유지하는 무시 기능도 제공합니다. 실제 비즈니스 니즈에 따라 선택하여 사용할 수 있습니다.자세한 사용 방법은 [캐시 키 규칙 설정](https://intl.cloud.tencent.com/document/product/228/35316)을 참고하십시오.
>
[](id:step5)
5. [CDN 콘솔](https://console.cloud.tencent.com/cdn)에 로그인한 후, [도메인 이름 관리]를 선택해 해당 도메인 설정을 찾습니다. [캐시 설정]>[캐시 키 규칙 설정]에서 캐시 규칙이 비즈니스와 원본 서버 실제 상황에 부합하는지 확인합니다.
   - 해당 문제가 맞는 경우, [5단계](#step5)를 실행합니다.
   - 해당 문제가 아닌 경우, [노드 캐시 만료 설정](https://intl.cloud.tencent.com/document/product/228/38424)을 참고하십시오.
