[](id:q6)
### 更新・プリフェッチ機能を使用する必要があるのはどのような場合ですか。
- 更新：お客様のオリジンサーバーにリソースの更新や、不正なリソースを削除する必要性、ドメイン名の設定変更があった場合は、ネットワーク全体のユーザーがノードのキャッシュの影響を受けて古いリソースにアクセスしてしまったり、古い設定の影響を受けたりすることを避けるために、タスクの更新を提出することで、ネットワーク全体のユーザーが最新のリソースにアクセスまたは正常にアクセスすることが可能となります。詳細な説明については[キャッシュ更新](https://intl.cloud.tencent.com/document/product/228/6299)をご参照ください。
- プリフェッチ：運用するイベントまたはインストールパッケージ/アップグレードパッケージのリリースなどがある場合は、プリフェッチタスクを提出し、事前に静的リソースをCDNアクセラレーションノードにプリフェッチすることで、オリジンサーバーの負荷を低減し、ユーザーサービスの可用性およびユーザーエクスペリエンスを向上させることができます。詳細な説明については、[キャッシュプリフェッチ](https://intl.cloud.tencent.com/document/product/228/39000)をご参照ください。

[](id:q1)
### 更新とプリフェッチはどう違うのですか。
- 更新後、ネットワーク全体のCDNノードからこのリソースのキャッシュを削除します。ユーザーリクエストがノードに到達すると、ノードはオリジンサーバーに戻って対応するリソースをプルしてユーザーに返し、ノードにキャッシュすることによって、ユーザーが最新のリソースを確実に取得できるようにします。
- プリフェッチした後、このリソースはネットワーク全体のCDNノードにあらかじめキャッシュされます。ユーザーリクエストがノードに到達すると、ノードでリソースを直接取得することができます。

[](id:q2)
### 更新・プリフェッチには何が必要ですか。有効になるまでにどのくらい時間がかかりますか。
- キャッシュ更新
 - URLの更新：1日あたりのURL更新数は最大で10,000個までです。更新ごとに送信されるURL数は1,000個以下で、更新タスクが有効になるまでに約5分かかります。ファイル設定のキャッシュ有効時間が5分未満の場合は、更新ツールを使用せずに、タイムアウトによる更新を待つことをお勧めします。
 - ディレクトリ の更新：1日あたりのディレクトリ更新数は最大で100個までです。更新ごとに送信されるURLディレクトリ数は500個以下で、更新タスクが有効になるまでに約5分かかります。フォルダ設定のキャッシュ有効時間が5分未満の場合は、更新ツールを使用せずに、タイムアウトによる更新を待つことをお勧めします。
- リソースのプリフェッチ
 - URLのプリフェッチ：1日あたりのURLプリフェッチ数は最大1000個までです。プリフェッチごとに送信されるURL数は500個以下で、プリフェッチタスクが有効になるまでの時間はプリフェッチファイルのサイズに依存し、約5分から30分かかります。

[](id:q3)
### オリジンサーバーリソースを変更後、CDNアクセラレーションノード上のキャッシュは、自動的にリアルタイムで更新されますか。
CDNアクセラレーションノード上のキャッシュコンテンツは、自動でのリアルタイム更新はされません。
- オリジンサーバーリソースを変更後、CDNキャッシュが有効期限前でも、CDNが自動的にオリジンサーバーに戻り最新のリソースを取得しない場合は、この時点ではオリジンサーバーリソースとCDNキャッシュが一致していないため、コンソールで設定した[キャッシュの有効期限の設定](https://intl.cloud.tencent.com/document/product/228/35317)から適切なキャッシュ有効期限を設定することができます。
- キャッシュ有効期限が短すぎると、CDNが頻繁にback-to-originすることになり、オリジンサーバーのトラフィック消費が増加します。キャッシュ有効期限が長すぎると、CDNキャッシュの更新が遅くなります。
- 特定リソースのキャッシュを自動で更新したい場合は、[キャッシュ更新](https://intl.cloud.tencent.com/document/product/228/6299)から自動でCDNキャッシュのクリーンアップをすることができます。キャッシュのクリーンアップ後、[キャッシュプリフェッチ](https://intl.cloud.tencent.com/document/product/228/39000)からCDNを自動でback-to-originしてリクエストし、オリジンサーバーの最新のリソースを取得します。あるいはユーザーが新たにリクエストして、自然にトリガーすることで、CDNをback-to-originし、最新のリソースを取得します。



[](id:q5)
### 更新・プリフェッチの記録を確認するにはどうすれば良いですか。
CDNコンソールで更新・プリフェッチの記録を確認することができます。詳細については、[操作の記録](https://intl.cloud.tencent.com/document/product/228/42176)をご参照ください。

[](id:q6)
### プリフェッチ時にカスタムリクエストヘッダーのプリフェッチを追加できますか。
現時点ではサポートしていません。


### 1日あたりの更新、プリフェッチのクォータ上限を上げるにはどうすれば良いですか。
CDNコンソール[クォータ管理](https://intl.cloud.tencent.com/document/product/228/46738)でCDNに関連するクォータ上限と使用状況を確認することができます。また、業務ニーズに応じて事前申請することにより、クォータ上限を一時的あるいは永続的にアップグレードすることができます。現在すでにサポートしているクォータは、URL更新クォータ、ディレクトリの更新クォータ、URLプリフェッチクォータです。
- 一時クォータ：業務における活動、運営シーンにおいて、一時的にクォータの増加が必要になった場合、クォータ管理から必要な時間範囲で一時クォータを申請することができます。一時クォータの有効期限が切れた後は、現在のクォータを永続クォータに戻すことができます。
- 永続クォータ：現在のクォータが日常の業務ニーズを満たしていない場合は、クォータ管理から対応する機能の永続クォータを申請することができます。しかし、永続クォータの承認は時間がかかるため、一時的な業務ニーズには一時クォータの申請をお勧めします。


### プリフェッチをする場合はどのような事項に注意が必要ですか。
ドキュメントをプリフェッチする際、CDNキャッシュが有効期限切れでない場合は、CDNが自動でオリジンサーバーに戻ってドキュメントを更新することはありません。ドキュメントを更新する場合は、キャッシュを更新してから、キャッシュプリフェッチを送信することをお勧めします。
- プリフェッチをする時は、自動的にback-to-originで必要なコンテンツをプルします。このため大量のプリフェッチタスクを送信した後、オリジンサーバーの帯域幅が増加します。オリジンサーバーの帯域幅の状況に基づき、送信するプリフェッチの同時実行タスクを制御することをお勧めします。
- ネットワーク全体のアクセラレーションドメイン名は、デフォルトの状態で、エッジノードと中間層ノードの2層アクセラレーション構造となっています。リソースがエッジノードにプリフェッチされる場合、発生するエッジ層のトラフィックは課金トラフィックに計上されます。中国本土のリージョンのプリフェッチは、デフォルトで中国本土の中間層ノードにプリフェッチされ、中国本土以外のリージョンのプリフェッチは、デフォルトで中国本土以外のエッジノードにプリフェッチされます。
