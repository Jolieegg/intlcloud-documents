本ドキュメントでは、COSコンソールでCDN経由のCOSアクセラレーションを実現する全体的な操作フローと具体的な操作方法を詳しく説明します。

## 前提条件
1. Tencent Cloudのアカウント登録を完了し、実名認証します。
2. CDNサービスを有効にします。詳細については、[CDNクイックスタート](https://intl.cloud.tencent.com/document/product/228/32978)をご参照ください。

## 操作ガイド
### バケットの作成
バケット作成の操作フローと方法については、[バケットの作成](https://intl.cloud.tencent.com/document/product/436/13309)をご参照ください。

### アクセラレーション設定
1. バケットの作成後に直接そのバケットの設定管理ページに進むか、またはバケットリストで設定対象のバケットの操作欄から**設定管理**をクリックして、設定管理ページに移動し、**ドメイン名管理**を選択します。
2. **デフォルトCDNアクセラレーション**を有効にします
**デフォルトCDNアクセラレーション**はシステムによってデフォルトで生成され、ユーザーはCDNアクセラレーションノードのドメイン名を有効または無効にすることを選択できます。
(1) デフォルトCDNアクセラレーションモジュールにおいて、【編集】をクリックし、現在のステータスを手動で有効化すると、デフォルトCDNアクセラレーションの設定に進みます
![](https://main.qcloudimg.com/raw/260fde070f4b2f999c0d9d09bec13d55.png)
(2) デフォルトCDNアクセラレーションの構成：
![](https://main.qcloudimg.com/raw/2b72c25d2bf11f0c53a2e8286fcecf07.png)
**オリジンサーバータイプ**：通常はデフォルトで**デフォルトオリジンサーバー**になっています。オリジンサーバーのバケットとして静的ウェブサイトを有効にしており、かつ静的ウェブサイトのアクセラレーションを希望する場合は、**静的ウェブサイトオリジンサーバー**を選択します。
**Back-to-Origin認証**：バケットがパブリック読み取りの場合、Back-to-Origin認証を有効にする必要はありません。バケットがプライベート読み取りの場合、CDNサービスの権限承認を追加し、手動でBack-to-Origin認証を有効にする必要があります。詳細については、[Back-to-Origin認証の有効化](https://intl.cloud.tencent.com/document/product/436/31505)をご参照ください。
**CDNサービス権限承認**：**CDNサービス権限承認の追加**をクリックし、CDNがバケット内のリソースにアクセスすることを選択してそれに同意します。
![](https://main.qcloudimg.com/raw/41e745800445225d042ef82c6febcc19.png)
(3) 設定が完了した後、**保存**をクリックすると、CDNアクセラレーションが有効になります
![](https://main.qcloudimg.com/raw/5ffc31cb49410b4685316e75860c9385.png)
>!
>- プライベート読み取りバケットに対して、Back-to-Origin認証とCDNサービス権限承認を同時に有効にすると、CDNがオリジンサーバーにアクセスする際に署名を必要としなくなります。CDNキャッシュリソースがパブリックネットワーク配信を行う際に、データセキュリティに影響を与えます。CDN認証を有効にすることをお勧めします。
>- 2022年5月9日より、Cloud Object Storage　(COS)サービスではデフォルトのCDNアクセラレーションドメイン名の新規追加をサポートしなくなりました。すでに有効にしている、または一度有効にしたデフォルトのCDNアクセラレーションドメイン名には影響がなく、引き続きご利用いただけますが、デフォルトのCDNアクセラレーションドメイン名の代わりにカスタムCDNアクセラレーションドメイン名を使用することをお勧めします。カスタムCDNアクセラレーションドメイン名の操作ガイドについては、[カスタムCDNアクセラレーションドメイン名の有効化](https://intl.cloud.tencent.com/document/product/436/31506)のドキュメントをご参照ください。
>
3. **カスタムCDNアクセラレーション**を有効にします
ユーザーはICP申告済みの**カスタムドメイン名**をバケットにバインディングし、CDNアクセラレーションを有効にすることができます。
>?COSコンソールで追加できるカスタムドメイン名は10個までです。
>
>(1) **カスタムCDNアクセラレーション**モジュールで【ドメイン名の追加】をクリックして、ICP申告済みのカスタムドメイン名を追加します
>![](https://main.qcloudimg.com/raw/eda34cc24d82cebf109e3507a2ae142f.png)
>(2) 追加するドメイン名の構成は次のとおりです。
>**ドメイン名**：バインディング対象のカスタムドメイン名（例えば`www.example.com`）を入力します。入力するドメイン名はICP申告済みであること、およびDNSサービスプロバイダで対応するCNAMEを設定していることを確認してください。詳細については、[CNAMEの設定](https://intl.cloud.tencent.com/document/product/228/3121)をご参照ください。
>**Back-to-Origin認証**：プライベート読み取りバケットに対して、オリジンサーバーのセキュリティを確保するために、Back-to-Origin認証を手動で有効にしてください。
>設定が完了した後、**保存**をクリックすると、ドメイン名の追加を完了できます。
>![](https://main.qcloudimg.com/raw/e21189d91929209ded554581d267a505.png)
>!
>
>- プライベート読み取りバケットに対して、Back-to-Origin認証とCDNサービス権限承認を同時に有効にすると、CDNがオリジンサーバーにアクセスする際に署名を必要としなくなります。CDNキャッシュリソースがパブリックネットワーク配信を行うため、データセキュリティに影響を与えます。CDN認証を有効にすることをお勧めします。
>- 2022年5月9日より、Cloud Object Storage (COS)サービスではデフォルトのCDNアクセラレーションドメイン名の新規追加をサポートしなくなりました。すでに有効にしている、または一度有効にしたデフォルトのCDNアクセラレーションドメイン名には影響がなく、引き続きご利用いただけますが、デフォルトのCDNアクセラレーションドメイン名の代わりにカスタムCDNアクセラレーションドメイン名を使用することをお勧めします。カスタムCDNアクセラレーションドメイン名の操作ガイドについては、[カスタムCDNアクセラレーションドメイン名の有効化](https://intl.cloud.tencent.com/document/product/436/31506)のドキュメントをご参照ください。
>
>(3) 保存すると、**CDN認証**欄にCDN認証機能スイッチが表示され、カスタムドメイン名のCDN認証を手動で有効化できます。
>**CDN認証：**タイムスタンプ認証設定を有効化すると、ユーザーコンテンツに対する悪質な盗用を防ぐことができます。ドメイン名の追加完了後に設定する必要があります。

COSコンソールでCDNアクセラレーションCOSを実現する詳細内容については、[COSドメイン名管理の概要](https://intl.cloud.tencent.com/document/product/436/18424)をご参照ください。


## 推奨設定
1. 設定完了後、[CDNコンソール](https://console.cloud.tencent.com/cdn)に移動してCOS下のリソースファイルに対してプリフェッチを行います。事前に静的リソースをCDNアクセラレーションノードにプリフェッチすることで、オリジンサーバーのストレスを軽減して、レスポンスとダウンロードの速度を向上させることができます。詳細については、[キャッシュプリフェッチ](https://intl.cloud.tencent.com/document/product/228/39000)をご参照ください。
2. クロスドメインのヘッダーパラメーターを設定します。リソースのクロスドメイン権限に関する問題を解決する場合、詳細は[HTTPレスポンスヘッダーの設定](https://intl.cloud.tencent.com/document/product/228/35320)をご参照ください。
3. クライアントのオリジンサーバーのリソースが変更されている場合、キャッシュを更新してからプリフェッチを行うことを推奨します。詳細は[キャッシュ更新](https://intl.cloud.tencent.com/document/product/228/6299)をご参照ください。
