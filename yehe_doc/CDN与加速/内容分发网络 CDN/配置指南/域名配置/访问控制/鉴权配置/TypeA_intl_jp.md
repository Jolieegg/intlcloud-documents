## アルゴリズムの説明
**URL形式へのアクセス**
`http://DomainName/Filename?sign=timestamp-rand-uid-md5hash`

>! アクセスURLに中国語を含むことはできません。

**アルゴリズムの説明**
- timestamp：10進数（UNIXタイムスタンプ）です。
- rand：ランダム文字列です。大文字と小文字、数字で構成される0～100桁のランダム文字列です。
- uid:0
- md5hash：MD5（ファイルパス-timestamp-rand-uid-カスタマイズキー）。

**リクエスト例**
`http://cloud.tencent.com/test.jpg?sign=1582791032-im1acp76sx9sdqe601v-0-dd63f95e739ed4b47427a129d21ef4e3`

>!MD5を計算する際に、リクエストパスが `http://cloud.tencent.com/test.jpg`の場合、MD5を計算する際のパスは`/test.jpg`となります。

## 設定ガイド
### パラメータの説明
TypeAに必要な設定は以下のとおりです：
![](https://main.qcloudimg.com/raw/b7da5881cba4ad972aa11f43bc2bc2ca.png))
**認証キーをカスタマイズする**：キーは6～40桁のアルファベットの大文字、小文字と数字で構成されています。キーを大切に保管してください。ユーザー側とサーバー側のみ知っている必要があります。
**認証パラメータ名をカスタマイズする**：例の中のsignを任意の1～100桁のアルファベットの大文字、小文字、数字、またはアンダーバーを組み合わせたパラメータ名に置き換え、CDNがリクエストを受信した後 、指定された認証パラメータに基づいて対応する値を取得し、MD5の計算を行い、それが伝達されたmd5hash値と一致すれば、認証は検証にパスし、検証にパスしない場合は403コードを直接返します。
**有効時間をカスタマイズする：**リクエストに含まれるtimestampと、設定された有効時間を介して、現在の時刻と比較し、リクエストが期限切れかどうかを判定します。期限切れの場合、403コードを直接返します。有効時間の単位は秒で、最大630720000秒まで設定可能です。

### 有効化対象
キー、パラメータ名、および期限切れ時間を設定した後、必要に応じて認証対象を指定でき、以下の3つのモードをサポートします。
![](https://main.qcloudimg.com/raw/148f6319984b1f3d99ccb186666cb425.png)

+ 指定されたドメイン名下のすべてのファイルを認証が必要なように設定できます。
+ 指定されたタイプのファイルを認証不要に、他のすべてのファイルは認証される必要があります。
+ 指定されたタイプのファイルは認証される必要があります。

## 注意事項
**キャッシュのヒット率**
TypeA認証方式が有効になっているドメイン名は、アクセスURLに認証パラメータが保持されます。CDNノードでリソースをキャッシュする時、対応するパラメータが自動的に無視され、ドメイン名キャッシュのヒット率には影響しません。
>!設定後は対応するパラメータを自動的に無視することで、設定された認証パラメータを無視することになり、認証範囲内のファイルのキャッシュキーに影響を与え、ここでの優先レベルは【キャッシュ設定 - キャッシュキールール設定】のキャッシュキールールを上回ることになります。
たとえば、ここでのTypeA設定が：認証パラメータ：sign - 認証範囲：jpgの場合、たとえ【キャッシュ設定 - キャッシュキールール設定】が「すべてのファイル - パラメータを無視しない」となっていても、jpgタイプのファイルについては「sign」パラメータを自動的に無視します。


**back-to-originのポリシー**
TypeA認証方式が有効になっているドメイン名は、アクセスする際の形式が次のとおりです。
`http://DomainName/Filename?sign=timestamp-rand-uid-md5hash`

認証が完了した後、命中されたCDNノードがない場合、ノードはback to originリクエストを送信します。形式はアクセスリクエストと一致しており、signパラメータは保持されます。オリジンサーバーは必要に応じて無視されるか、２次検証が行われます。
