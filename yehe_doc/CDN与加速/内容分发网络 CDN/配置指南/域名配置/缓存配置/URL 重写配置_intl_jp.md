## 設定シナリオ

実際にアクセスするURLをオリジンサーバーと一致するURLに変更する必要がある場合、Tencent Cloud CDN はURL書き換え設定機能を提供しています。

URL書き換え設定をカスタマイズすることにより、URL302を宛先URLにリダイレクトできます。

## 設定ガイド

### 設定の確認

[CDNコンソール](https://console.cloud.tencent.com/cdn)にログインし、左側のメニューバーで【ドメイン名管理】を選択し、ドメイン名操作列の【管理】をクリックして、ドメイン名設定画面に入ります。タブを【キャッシュ設定】に切り替えて、【URL書き換え設定】が表示されます。

デフォルトでは、URL書き換え設定は無効になっています。
![](https://main.qcloudimg.com/raw/01f93aaa70c523ae0bb1ab5debae8558.png)


### 新しいルール

必要に応じて書き換えルールを追加し、URL書き換え設定機能を有効にすることができます。

**設定の制約**
+ １つのドメイン名に最大10件の書き換えルールまで登録できます。
+ 複数件のルールは優先順位を変更できます。最下位ルールの優先順位が最上位のものよりも高くなります。
+ 書き換えられるURL：フルパス一致（`/`で始まる）、正規表現をサポートしています。
+ ターゲットURLは`/`で始まります。
+ 書き換えられるURLとターゲットURLが入力できる長さは1024文字を超えることはできません。

【書き換えルールの追加】をクリックします。
![](https://main.qcloudimg.com/raw/97ea8713395f3af8654c39be97f124d3.png)
ルールが追加された後も、全体の設定はデフォルトで無効になるため、ライブ ネットワーク上のサービスには影響しません。

>?無効の状態でも以下の設定を変更できますが、ライブネットワークには配布されません。有効にされた場合にのみ、ライブネットワーク設定が配信されます。

ボタンをクリックして設定を有効にし、追加された書き換えルールをライブネットワークに配信することができます。
![](https://main.qcloudimg.com/raw/214b034e578d5eaac0a63cacd49f1e2d.png)

リクエストされたURLが現在設定されているルールと一致する場合、対象リクエストは対応するターゲットURLにリダイレクトされます。

### ルールの変更

追加された書き換えルールは変更できます。書き換えルールの操作列の【変更】をクリックして変更できます。

### ルールの削除

追加された書き換えルールは削除できます。書き換えルールの操作列の【削除】をクリックして削除できます。



>! ご利用のアクセラレーションドメイン名サービス地域がグローバルアクセラレーションの場合、**URL書き換え設定**はグローバルに有効になり、中国国内と中国国外との差異化設定に対応しません。

## 設定例

アクセラレーションドメイン名 `www.test.com`の**URL書き換え設定**が次の場合、
![](https://main.qcloudimg.com/raw/19edbf944b4e727b7c62270f2d8078cf.png)

実際のアクセス状況は次のとおりです。

+ クライアントから `www.test.com/access`がリクエストされると、CDNノードは` www.test.com/origin/index.html`のコンテンツを返します。
+ クライアントから`www.test.com/test/a.jpg`がリクエストされると、CDNノードは`www.test.com/testnew/b.jpg`のコンテンツを返します。



