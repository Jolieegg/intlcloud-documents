
## 設定シナリオ

実際のアクセスURLをオリジンサーバーと一致するURLに変更する必要がある場合、Tencent Cloud CDNはアクセスURL書き換え設定機能を提供しています。

アクセスURLの書き換え設定をカスタマイズすることによって、302 URLを目標URLにリダイレクトすることができます。

## 設定ガイド

### 設定の確認

[CDNコンソール](https://console.cloud.tencent.com/cdn)にログインし、左側のメニューバーで【ドメイン名管理】を選択し、ドメイン名操作列の【管理】をクリックして、ドメイン名設定画面に入ります。タブを【キャッシュ設定】に切り替えて、【アクセスURL書き換え設定】が表示されます。

デフォルトの状態では、アクセスURL書き換え設定は無効状態になっています。
![](https://main.qcloudimg.com/raw/01f93aaa70c523ae0bb1ab5debae8558.png)


### ルールの追加

必要に応じて書き換えルールを追加できます。【書き換えルールの追加】をクリックします。
<img src="https://main.qcloudimg.com/raw/97ea8713395f3af8654c39be97f124d3.png"  style="height:300px"></img>

**設定の制約**
+ 1つのドメイン名につき、最大100件の書き換えルールを追加できます。
+ 複数あるルールは優先順位を変更できます。下部の優先順位が上部のものよりも高くなります
+ 書き換え予定のURL：「/」で始まり、フルパス一致（例：/test/a.jpg）とワイルドカード `*`一致（例：/test/\*/\*.jpg）をサポートします。ファイルディレクトリを指定する場合は、「/」で終わることはできません（例：/test）。
+ 目標 Host：デフォルトは現在のドメイン名です（デフォルトではhttpヘッダーがつきます）。その他のドメイン名に変更できますが、 `http://`または `https://`のヘッダーを含める必要があります。
+ 目標 Path：「/」で始まり（例：/newtest/b.jpg）、ワイルドカード `*`は`$n`（n=1,2,3...，例：/newtest/$1/$2.jpg）でキャプチャできます。ファイルディレクトリを指定する場合は、「/」で終わることはできません（例：/test）。
+ ワイルドカード `*` は最大5件入力できます。キャプチャのプレースホルダー `$n` は最大10件入力できます。
+ 中国語のコンテンツはサポートしていません。入力欄のコンテンツの長さは1024文字以内とすること。




## 設定例

アクセラレーションドメイン名`www.test.com`の**アクセスURL書き換え設定**を行う場合は次となります。
![](https://main.qcloudimg.com/raw/214b034e578d5eaac0a63cacd49f1e2d.png)

実際のアクセス状況は次のとおりです。

+ クライアントが `www.test.com/test/a.jpg`をリクエストした場合、CDNノードは `www.test.com/newtest/b.jpg`コンテンツを返します。
+ クライアントが `www.test.com/test/a.png`をリクエストした場合、CDNノードは `www.newtest.com/newtest/a.png`コンテンツを返します。



