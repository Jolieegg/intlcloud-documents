CDN provides a self-diagnostic tool to help you troubleshoot URL access failure. It locates the problem by checking the DNS resolution, linkage quality, node status, origin server, and data access consistency, and offers relevant solutions.

>! The resource URL to be diagnosed should be an **activated** domain name under your account. As the bandwidth generated during the diagnosis incur charges, we recommend the diagnosed resource being no more than 200 MB in size.



## Fault Diagnosis
### Diagnosis process

If a resource URL cannot be accessed, you can initiate diagnosis through **Fault Self-diagnosis** in the following steps:
1. Log in to the [CDN console](https://console.cloud.tencent.com/cdn) and select **Inspect Tool** -> **Fault Self-diagnosis**.
2. On the **Fault Self-diagnosis** page, enter the URL to be diagnosed. The URL should begin with `http://` or `https://`.
 ![](https://main.qcloudimg.com/raw/0b5b89dee36676027aeb15a118b4584e.png)
3. Click **Get a Diagnosis Link** and the link address will appear on the page.
 ![](https://main.qcloudimg.com/raw/35e6dc6b335db10c63dc729cbe11ddbe.png)
4. Click the link to open the diagnosis page where diagnosis information will be collected. Do not close the page during the diagnosis progress. You can manually close it after the diagnosis is completed.
    ![](https://main.qcloudimg.com/raw/1e41c147e1e0ae216efc6635a43b1298.png)
5. You can also send the diagnosis link to others for local fault diagnosis. After the diagnosis is completed, you need to close the webpage manually.

>!
- The diagnosis link is valid for 24 hours and supports up to 10 fault diagnoses.
- You can copy the available diagnosis links on the "Diagnostic Report" page.

## Diagnostic Report
### Viewing the report
1. After the diagnosis is completed, click **Diagnostic Report** to view the reports, which are displayed in a table in chronological order. The contents in the table include:
	- The URL for which a diagnosis link is generated.
	- The target area of the URL diagnosis.
	- The diagnosis link corresponding to the URL.
	- The time when the diagnosis link was generated.
	- The status of the diagnosis link.
	- The number of remaining available diagnoses of the diagnosis link.

![](https://main.qcloudimg.com/raw/47c48777ace8428bb065695e1475600e.png)

2. Click **Expand** in the operation column to view the report generated by each diagnosis and the diagnosis results.
![](https://main.qcloudimg.com/raw/a439f2dbcadcb6d2790e846416717cea.png)
3. The diagnostic reports will make an overall assessment based on the diagnosis for each step as shown below:
 - Normal
 - Abnormal
 - Page abnormally closed. This happens generally when the page is closed before the diagnosis is completed.
4. Click **View Report** to view the diagnosis details and suggestions.

### Report interpretation
1. The first part of the report displays diagnosis information, including:
 - Diagnostic report ID.
 - URL to be diagnosed.
 - Time when the diagnosis was triggered.
![](https://main.qcloudimg.com/raw/a7b7c60533782c95927d4860491594fd.png)

2. The second part gives an overview of the diagnosis process and the results of each diagnosis module. Exceptional modules are clearly identified. Diagnosis modules include:
 - Client information check result.
 - DNS check result.
 - CNAME check result.
 - Network linkage check result.
 - Access node check result.
 - Origin-pull node check result.
 - Origin server check result.
![](https://main.qcloudimg.com/raw/1298a6d0b2e72b70ca202a03660b409f.png)

3. The third part elaborates on the diagnosis results.
 #### Section 1. Client information
Information such as client IP, district/ISP, and User-Agent, referer, and request method of the initiated HTTP/HTTPS request are obtained. Without the client information, some subsequent checks cannot be conducted.
![](https://main.qcloudimg.com/raw/8219224766176ed87ebb421330170f4a.png)

 #### Section 2. DNS check
The client's DNS IP is collected and checked against the client IP, to determine whether exceptions in local DNS configuration are causing issues in scheduling requests to the optimal cache nodes.
![](https://main.qcloudimg.com/raw/4ab79b159c3e983cd6db7c1fefeae9ea.png)

 #### Section 3. CNAME check
The CNAME configuration of the domain name is obtained. The CNAME resolution of the domain name needs to be configured with the correct domain name suffixed with `*.cdn.dnsv1.com` (default); otherwise, requests will be unable to reach CDN nodes.
![](https://main.qcloudimg.com/raw/c3bbbb52440985415d9433b838dbde42.png)
>! If CNAME configuration check fails, the requests will not reach CDN nodes and subsequent diagnoses will not be conducted.

 #### Section 4. Network linkage check
Multiple websites are checked locally to obtain the client's network status. If a website cannot be accessed due to local proxy configuration, the network linkage check will fail, and subsequent diagnoses will not be conducted.
![](https://main.qcloudimg.com/raw/be249d3593b9956bf4e03393f02bb1d4.png)

 #### Section 5. Access node check
After a client request reaches a CDN node, node information will be collected, including node IP, node district/ISP, status code returned by node, hit status, and resource MD5.
 - If a resource has already been cached on a CDN node, it will directly be hit, and origin-pull node check will not be conducted.
 - In case of a cache miss, origin-pull node check will be conducted.
 - If the status code returned by the URL is 301, 302, or 504, node check information will not be obtained, and the subsequent checks will not be conducted.
 - If an ACL has been configured for the domain name, the access node will directly return 403, and the hit status is **hit**.
![](https://main.qcloudimg.com/raw/cce938713c83879c50899efb71b9ea2e.png)

 #### Section 6. Origin-pull node check
 1. If the resource is directly returned by a CDN node, the hit status of both the access node and the origin-pull node is **hit**, and CDN will proceed to check the origin server to help check whether the status codes and contents returned from the origin server are the same as those of the node.
![](https://main.qcloudimg.com/raw/88ec7bc47877ef3c96b468a2a9c19a00.png)
 2. If the resource is not directly returned by a CDN node, the hit status of both the access node and the origin-pull node is **missed**, and the contents will be returned by the origin server.
![](https://main.qcloudimg.com/raw/ce8f450c620a6ed2b13de186a04b677b.png)
 3. If an exceptional status code is generated at this time, you can compare the origin server status code and file MD5 value against those returned by the access module to determine whether the exception is caused by a CDN node or by the origin server, and then fix the problem accordingly.

>?If the diagnostic report cannot help you solve the problem, please [submit a ticket](https://console.cloud.tencent.com/workorder/category) or contact Tencent Cloud technical support.

