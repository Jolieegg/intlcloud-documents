## どのようなタイミングでドメイン名の所有権を検証しますか？
1. ドメイン名を初めて追加した際（例：a.example.com）に、そのドメイン名を追加した後、同じレベルのドメイン名（例：`b.example.com`）とサブドメイン名が検証済みのドメイン名と見なされ、デフォルトでは検証なしで追加できます。ただし、`example.com`のような上位ドメイン名の追加には検証が必要です。
2. 別のアカウントでサブドメイン名にアクセスする場合、現在のドメイン名の所有権を確認するためにドメイン名の所有権を検証する必要があります。検証に合格した場合、ドメイン名を取得することで現在のアカウントでアクセスできます。
3. 同じレベルのワイルドカード形式のドメイン名を追加する場合、検証が必要です。例えば、`a.example.com`を追加済みの場合でも、`*.example.com`の追加に検証が必要となります。`*.a.example.com`が下位のワイルドカード形式のドメイン名のため、検証なしで追加できます。

## 方法1：DNS名前解決による検証（推奨）

1. ドメイン名を追加する場合、追加するドメイン名を検証する必要があれば、そのドメイン名の下にドメイン名の所有権を検証する必要がある旨のメッセージが表示されます。**検証方法**をクリックしてください。
![](https://qcloudimg.tencent-cloud.cn/raw/1c6915b095d74f4358923be2ec7740dd.png)
2. 検証方法は、デフォルトではDNS名前解決による検証です。
DNS名前解決による検証を選択した場合、そのドメイン名の名前解決プロバイダーのプライマリドメイン名に、ホストのレコード値が`_cdnauth`のTXTレコードを追加してください。
>！追加するドメイン名が`c.b.a.example.com`、`*.example.com`あるいは`test.example.com`であっても、マルチレベルドメイン名配下のホストのレコード値をプライマリドメイン名に追加してください。例えば、ドメイン名`c.b.a.example.com`を追加する場合、名前解決レコード`_cdnauth.example.com`を追加します。
>
![](https://qcloudimg.tencent-cloud.cn/raw/e1da0524ad0781544052fd65195d9798.png)
**Tencent Cloud DNS解決の追加方法の参考情報：**
解決サービスプロバイダがTencent Cloud DNSPodを使用している場合は、[DNS 解決 DNSPod コンソール](https://console.cloud.tencent.com/cns)に移動し、ドメイン名を見つけて[解決]をクリックし、レコードタイプがTXTのDNSレコードを追加します。ホストレコードに`_cdnauth`を入力し、レコードタイプとしてTXTを選択し、レコード値にTencent Cloud CDN によって提供されたレコード値を入力し、その他のパラメータはデフォルト値を保持します。
**Alibaba Cloud DNS解決の追加方法の参考情報：**
解決サービスプロバイダがAlibaba Cloudを使用している場合は、Alibaba Cloudのドメイン名解決コンソールで当該ドメイン名を見つけ、右側の解決設定をクリックします。レコードタイプとしてTXTを選択し、Tencent Cloud CDN によって提供されたホストレコードとレコード値を入力し、その他のパラメータはデフォルト値を保持します。
3. 名前解決レコードを追加した後、TXTレコード値が反映されるまで待ちます。反映されると、下側の検証ボタンをクリックし、ドメイン名の所有権の検証を完了します。検証に失敗した場合、現在のTXTレコード値がドメイン名の名前解決プロバイダー側で有効になっているか、または、入力したTXTレコード値が正しいかを確認してください。[TXTレコードが有効になっているかどうかを確認する方法は？](#q1)
4. ドメイン名の所有権の検証を完了した後、現在のドメイン名がすでに別のアカウントに追加されており、現在のアカウントに切り替えて追加する必要がある場合は、[取得]ボタンをクリックしてドメイン名を取得する必要があります。ドメイン名が取得された後、元のアカウントのドメイン名構成が消去されることに注意してください。


## 方法2：ファイルによる検証
1. ドメイン名を追加する場合、追加するドメイン名を検証する必要があれば、そのドメイン名の下にドメイン名の所有権を検証する必要がある旨のメッセージが表示されます。**検証方法**をクリックしてください。
![](https://qcloudimg.tencent-cloud.cn/raw/140a8b980bd0c30c0336dcd8f8e3607e.png)
2. 検証方法でファイルによる検証を選択します。
![](https://qcloudimg.tencent-cloud.cn/raw/8883258277fef3bf2e42ceffb489324a.png)
3. クリックしてファイルverification.htmlをダウンロードします。
4.このファイルをお客様のプライマリドメイン名のサーバー（たとえば、CVM、COS、Alibaba Cloud ECS、Alibaba Cloud OSSなど）のルートディレクトリにアップロードします。たとえば、ドメイン名`test.example.com`を追加する場合、このファイルを`example.com`または`test.example.com`のルートディレクトリにアップロードする必要があります。
>!ファイルによる検証は、サブドメイン名にファイルをアップロードして検証することをすでにサポートしていますが、DNS検証は現在サポートされていません。サブドメイン名を通じてドメイン名の所有権を検証する必要がある場合は、ファイルによる検証を使用してください.
5. `http://example.com/verification.html`または`http://test.example.com/verification.html`経由でこのファイルにアクセスできることを確認した後、検証ボタンをクリックして検証を行います。ファイルにあるレコード値が提供されたレコード値と一致すれば、検証に成功します。検証に失敗した場合、前述したリンクにアクセスできること、および正しいファイルをアップロードしたことを確認してください。ファイルのリンクにアクセスし、ダウンロードしたファイルと一致するかを比較することで確認できます。
>! ファイルによる検証は現在、ドメイン名の取得をサポートしていません。ドメイン名を取得する必要がある場合は、DNS解決の検証方法を使用してドメイン名を取得してください。


**具体的なシナリオの操作例：**
アクセラレーションの対象ドメイン名が`a.test.com`、オリジンサーバーがCloud Object Storage(COS)の場合：
1. 生成された検証ファイルverification.htmlをCloud Object Storage (COS)のルートディレクトリにアップロードします。
2. アクセラレーションドメイン名の解決サイトにCNAMEレコードを1件追加し、さらにそれをCOSオリジンサーバーのドメイン名にポイントします。
3. 上記の操作が完了したら、http(https)://アクセラレーションドメイン名/verification.htmlから検証ファイルにアクセスできることを確認します。**検証**ボタンをクリックすると、検証に成功できます。

## 方法3：APIインターフェース操作
1. まず、CreateVerifyRecordインターフェースを呼び出して、追加対象のドメイン名のTXT解決レコードを生成します。
```
{
  "Response":{
    "Record": "202009071516044acd018wf498457628cn75ba018ec9cv",
    "RecordType": "TXT"
    "RequestId": "8518c99c-a8eb-4930-a7d0-eff586d9cc37",
    "SubDomain": "_cdnauth",
   }
}
```
2. ドメイン名解決サイト（DNSPODなど）でこのTXT解決レコードを構成します。
3. VerifyDomainRecordインターフェースを呼び出して、解決が有効になっているかどうかを確認します。
```
{
  "Response":{
    "RequestId": "b6926bb2-d0b5-42bc-b17f-e4402bdb9e9b",
    "Result": "true"
   }
}
```
4. 検証が成功したら、[AddCdnDomain](https://intl.cloud.tencent.com/document/product/228/34015)インターフェースを呼び出してドメイン名を追加できます。


## よくあるご質問
[](id:q1)

### どのように手動でドメイン名の所有権の検証に使用されるTXTレコード値が有効になっているかを確認しますか？
**Windows OSの場合：**
たとえば、追加するドメイン名が`test.example.com`の場合、cmdコマンドラインを起動し、`nslookup -qt=txt _cdnauth.example.com`を入力して実行します。出力されたTXTの結果で、名前解決レコードが有効になっているか、または正しいかを確認できます。
<img src="https://staticintl.cloudcachetci.com/yehe/backend-news/7VQU778_%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20230310151540.png" width="70%">
**Linux/Mac OSの場合：**
たとえば、追加するドメイン名が`test.example.com`の場合、コマンドラインインターフェースで`dig _cdnauth.example.com txt`を入力します。出力されたTXTの結果で、名前解決レコードが有効になっているか、または正しいかを確認できます。
<img src="https://qcloudimg.tencent-cloud.cn/raw/6b65e488b8b52745e8a6a4431c112975.png" width="70%">

### VODドメイン名を追加できない旨のメッセージが出力された場合、どうすればよいですか？
ご利用中のドメイン名がすでにVODのカスタムデリバリーアクセラレーションドメイン名に追加されています。同じアクセラレーションドメイン名を繰り返して設定できないため、CDNコンソールにもこのアクセラレーションドメイン名を追加する必要があります。まず、VODからアクセラレーションドメイン名を削除します（ドメイン名を禁止してから削除してください。これは禁止だけにすると問題が依然として発生するためです）。削除して約1分後に、CDNコンソールにアクセスするか、異なるサブドメイン名でCDNコンソールにアクセスしてください。 
