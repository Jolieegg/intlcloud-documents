## 概要
CVMOSの使用中に、マシンgrubガイドファイルの消失、システムキーファイルの欠落、lib動的ライブラリファイルの破損/欠落などの問題が発生した場合は、OSが修復を完了するためにシングルユーザーモードを開始できない可能性があります。この場合はCVMレスキューモードを使用してシステムを修復する必要があります。ここではCVMコンソールを介してレスキューモードを使用する方法について説明します。


## 操作手順

### レスキューモードの開始

<dx-alert infotype="notice" title="">
レスキューモード開始前に、誤操作などによる影響を防止するため、インスタンスをバックアップすることを強くお勧めします。CBSでは[スナップショットの作成](https://intl.cloud.tencent.com/document/product/362/5755)を介してバックアップでき、ローカルシステムディスクでは[カスタムイメージの作成](https://intl.cloud.tencent.com/document/product/213/4942) を介してイメージをバックアップできます。
</dx-alert>

1. [CVMコンソール](https://console.cloud.tencent.com/cvm/instance/index?rid=1)にログインします。
2. インスタンス管理ページで、実際に使用されているビューモードに従って操作します。
<dx-tabs>
::: リストモード
下図に示すように、インスタンスが配置される行右側の**その他** > **運用保守と検査** > **レスキューモードの開始**を選択します。
![](https://qcloudimg.tencent-cloud.cn/raw/1c550dfc43f5b136401f877a1621a84e.png)
:::
::: タブモード
下図に示すように、インスタンスが配置されるタブを選択し、右上方の**その他操作** > **運用保守と検査** > **レスキューモードの開始**を選択します。
![](https://qcloudimg.tencent-cloud.cn/raw/633e92a792afa8d19e735db38c7e5598.png)
:::
</dx-tabs>
3. [](id:step3)下図に示すように、ポップアップした「レスキューモードの開始」ウィンドウで、レスキューモード中にインスタンスにログインするためのパスワードを設定します。
<dx-alert infotype="notice" title="">
- 現在、レスキューモードはLinuxインスタンスのみをサポートしており、Windows インスタンスをサポートしていません。Windowsインスタンスを操作してレスキューモードを開始する場合は、デフォルトでLinuxレスキューモード（CentOS 7.5 64ビット）になります。
- レスキューモードでのインスタンスユーザー名はデフォルトで`root`です。
- インスタンスはシャットダウン状態でのみレスキューモードを開始できます。強制シャットダウンはデータの消失やファイルシステムの破損を引き起こす可能性がありますので、ここではインスタンスをシャットダウンした後に操作することをお勧めします。インスタンスのシャットダウン操作については、[インスタンスのシャットダウン](https://intl.cloud.tencent.com/document/product/213/4929)をご参照ください。
</dx-alert>
<img src="https://qcloudimg.tencent-cloud.cn/raw/0c4462f0c86de84a23cac475e0541c84.png"/>
4. **レスキューモードの開始**をクリックします。
このとき、インスタンスがレスキューモードに入っていることを確認できます。下図に示すように、インスタンスの状態が表示されたら、正常にレスキューモードに入ったことを意味します。次の手順を参考に、できる限り早急にインスタンスを修復してください。
![](https://qcloudimg.tencent-cloud.cn/raw/46661eec9cabb65ab9ba358015373492.png)



### レスキューモードを使用してシステムを修復します
1. `root`アカウントおよび [手順3](#step3) で設定したパスワードを使用し、次の方式でインスタンスにログインします。
 - インスタンスにパブリックIPが有る場合は、[SSHを使用してLinuxインスタンスにログイン](https://intl.cloud.tencent.com/document/product/213/32501)をご参照ください。
 - インスタンスにパブリックIPがない場合は、[VNCを使用してLinuxインスタンスにログイン](https://intl.cloud.tencent.com/document/product/213/32494)をご参照ください。
2. ログインに成功したら、次のコマンドを順に実行してシステムディスクのルートパーテーションをマウントします。
レスキューモードでのインスタンスのシステムディスクデバイス名は`vda`、ルートパーテーションは`vda1`で、デフォルトではマウントされていません。
```
mkdir -p /mnt/vm1
```
```
mount /dev/vda1 /mnt/vm1
```
マウントに成功したら、ルートパーテーション内のデータを操作できるようになります。`mount -o bind`コマンドを使用して元のファイルシステムのサブディレクトリの一部をマウントし、かつ`chroot`コマンドを使用して指定のルートディレクトリでコマンドを実行することもできます。具体的な操作コマンドは次のとおりです。
```
mount -o bind /dev /mnt/vm1/dev
mount -o bind /dev/pts /mnt/vm1/dev/pts
mount -o bind /proc /mnt/vm1/proc
mount -o bind /run /mnt/vm1/run
mount -o bind /sys /mnt/vm1/sys
chroot /mnt/vm1 /bin/bash
```


### レスキューモードの終了
1. インスタンスの修復が完了したら、実際に使用するビューモードに応じて、次の手順に従いレスキューモードを終了します。
<dx-tabs>
::: リストモード
下図に示すように、インスタンスが配置される行右側の**その他** > **運用保守と検査** > **レスキューモードの終了**を選択します。
![](https://qcloudimg.tencent-cloud.cn/raw/42b6657af00132b39a4b3242748a449c.png)
:::
::: タブモード
下図に示すように、インスタンスが配置されるタブを選択し、右上方の**その他操作** > **運用保守と検査** > **レスキューモードの終了**を選択します。
![](https://qcloudimg.tencent-cloud.cn/raw/24df2366e42e1bdc22c171d871073c68.png)
:::
</dx-tabs>
2. インスタンスがレスキューモードを終了すると、シャットダウン状態になります。[インスタンスの起動](https://intl.cloud.tencent.com/document/product/213/38168) を参考に起動すれば、使用を再開できます。

