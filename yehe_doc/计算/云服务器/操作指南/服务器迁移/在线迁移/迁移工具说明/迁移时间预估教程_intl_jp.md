
このドキュメントでは、オンラインマイグレーションによって、ソースサーバー上のシステム、アプリケーションプログラムなどを自分で作成したコンピュータルーム（IDC）やクラウドプラットフォームなどのソース環境からTencent Cloud CVMに移行する場合にかかる時間を予測する方法についてご紹介します。

移行時間は主に移行中のデータ転送速度の影響を受けます。移行元サーバーから移行先リージョンのサーバー間の転送速度をテストすることで、移行時間を予測できます。

## 異なるシナリオにおける移行時間の予測

### シナリオ1

移行タスクの移行先タイプがCVMの場合、移行時間は主に実際のデータ転送時間であると予測されます。

例えば、移行元サーバーの移行対象の全ディスクデータの実際の使用量が50GB、アウトバウンド帯域幅が100Mbpsの場合、全体の移行時間は1.14時間と予測されます。手順は次のとおりです：

1. 単位の換算
 - 実際のブロードバンド速度をMB/sに換算します。100Mbps = 100 / 8 = 12.5MB/s
 - 実際のディスクデータ量をMBに換算します。50GB = 50 × 1024 = 51200MB
2. 実際のデータ移行時間の推定
51200 / 12.5 = 4096秒 = 1.14時間



### シナリオ2

移行タスクの移行先タイプがCVMイメージの場合、移行時間には主に実際のデータ転送時間およびイメージ制作時間が含まれます。

例えば、移行元サーバーの移行対象の全ディスクデータの実際の使用量が50GB、アウトバウンド帯域幅が100Mbpsの場合、全体の移行時間は1.23時間と予測されます。手順は次のとおりです：

1. 単位の換算
 - 実際のブロードバンド速度をMB/sに換算します。100Mbps = 100/8 = 12.5MB/s
 - 実際のディスクデータ量をMBに換算します。50GB = 50 × 1024 = 51200MB
2. 実際のデータ移行時間の推定
51200 / 12.5 = 4096秒 = 1.14時間
3. イメージ制作時間です。制作速度は約160MB/s
51200 / 160 = 320秒 = 0.089時間
4. 総移行時間
1.14+0.089=1.23時間。



## 関連操作：データ転送速度のテスト

**iperf3**ツールを使用してデータ転送速度をテストすることができます。例えば、クライアントからサーバーまでのデータ転送の帯域幅、速度などをテストします。


### 転送速度の影響因子

- 移行元サーバーのアウトバウンド帯域幅と移行先インスタンスのインバウンド帯域幅。
例えば、移行元サーバーのアウトバウンド帯域幅が50Mbps、移行先インスタンスのインバウンド帯域幅が100Mbpsの場合、理論上、実際の転送速度は50Mbpsを超えることはありません。
- 移行中は常に帯域幅を完全に占有するわけではありません。移行中は移行先のインスタンス（または中継インスタンス）のインバウンド帯域幅を動的に調整することができます。
- 移行元サーバーと移行先インスタンスが異なるリージョンにある場合、同じリージョンにある場合と比べて転送速度は遅くなります。

<dx-alert infotype="explain" title="">
- コンソールによるオンラインマイグレーションの場合、移行先がCVMイメージであれば、移行中に中継インスタンス（名称はdo_not_delete_csm_instance）が作成されることがあります。帯域幅上限は50Mpbsです。
- 移行中はコンソール上で移行先のインスタンス（または中継インスタンス）のインバウンド帯域幅を動的に調整し、移行速度を制御することができます。
</dx-alert>



### Tencent Cloud Linux CVMに移行する場合の速度テスト

例えば、コンソールのオンラインマイグレーション機能により、サーバーをTencent Cloud CentOS 7.5インスタンスに移行する場合、その転送速度のテスト手順は次のようになります：

1. 移行先リージョンに従量課金のCentOS 7.5インスタンスを作成します。
<dx-alert infotype="explain" title="">
- 移行先がCVMイメージであれば、移行中にCentOS 7.5の中継インスタンスが作成されることがあります。速度のテストを行いたい場合は、標準型かつCPU、メモリ構成が比較的低いマシンモデルを選択し、実際の移行時のシナリオにより近づけて行うことをお勧めします。
- iperf3サーバーのデフォルトポートはTCP 5201であり、テストするCentOS 7.5インスタンスのセキュリティグループのインバウンド方向にTCP 5201ポートを追加および開放してください。
</dx-alert>
2. 移行先のテストインスタンスと移行元サーバーにそれぞれiperf3ツールをインストールします。
 - 次のコマンドを実行し、移行先のCentOS 7.5インスタンスにiperf3ツールをインストールします。
```sh
yum -y install iperf3
```
 - 移行元サーバーにiperf3ツールをインストールします。移行元サーバーのLinuxリリースバージョンに応じて、対応するインストールコマンドを使用してiperf3ツールをインストールしてください。
3. 次のコマンドを実行し、移行先のCentOS 7.5テストインスタンスのiperf3をサーバーとして起動します。
```sh
iperf3 -s
```
「Server listening on 5201」などのメッセージが返されれば、起動は成功です。
4. 次のコマンドを実行し、移行元サーバーでiperf3をクライアントとして起動します。
```sh
iperf3 -c [移行先インスタンスIP]
```
返されるテスト結果は次のように表示され、移行元サーバーとCentOS 7.5テストインスタンス間の転送速度はおよそ111Mbpsであることがわかります。
![](https://qcloudimg.tencent-cloud.cn/raw/8cda488801e4756c54ac6e7c986a7ba2.png)





