## 概要
Tencent Cloudが提供するパブリックイメージを使用するだけでなく、カスタムイメージを作成することもできます。カスタムイメージを作成した後、Tencent Cloudコンソールでこのイメージと同一構成のTencent Cloud CVMインスタンスをすばやく作成することができます。


<dx-alert infotype="explain" title="">
イメージの基盤となるデータストレージは、CBSスナップショットサービスを使用します。
 - カスタムイメージを作成する場合、デフォルトでイメージに関連付けられたスナップショットが作成されます。カスタムイメージを保持すると一定のスナップショット料金が発生します。詳細については、[Billing Overview](https://intl.cloud.tencent.com/document/product/362/32415)をご参照ください。
</dx-alert>




## 注意事項

- 各リージョンは、最大10個のカスタムイメージをサポートします。
- Linuxインスタンスにデータディスクがあっても、システムディスクにのみイメージを作成する場合は、`/etc/fstab`にデータディスク構成が含まれていないことを確認してください。そうしないと、このイメージで作成したインスタンスを正常に起動できません。
- イメージの作成には10分以上かかる場合があります。具体的な時間はインスタンスのデータサイズによって異なります。業務への影響を避けるためには、事前に関連準備を行ってください。
- コンソールまたはAPIで CBM インスタンスを使用してカスタムイメージを作成することはできません。CVMインスタンスを使用してカスタムイメージを作成することができます。
- Windowsインスタンスがドメインに参加し、ドメインアカウントを使用する必要がある場合は、カスタムイメージを作成する前に、Sysprep操作を実行し、インスタンスがドメイン参加後にSIDが一意になるようにしてください。詳細については、 [Sysprepを実行してドメイン参加後のCVMの一意のSIDを確保](https://intl.cloud.tencent.com/document/product/213/35876)をご参照ください。

## 操作手順
<dx-tabs>
::: コンソールからのカスタムイメージの作成

#### インスタンスのシャットダウン（オプション）
1. [CVMコンソール](https://console.cloud.tencent.com/cvm)にログインし、対応するインスタンスのシャットダウンが必要かどうかを確認します。
<dx-alert infotype="notice" title="">
2018年7月以降にパブリックイメージを元に作成されたインスタンス（システムディスクはCBS）はオンラインイメージ制作（インスタンスをシャットダウンせずにイメージを制作すること）をサポートしています。これ以外でのインスタンスは、インスタンスをシャットダウンしてからイメージを制作し、イメージが現在のインスタンスデプロイ環境と完全に一致するようにしてください。
</dx-alert>
  - インスタンスをシャットダウンする必要がある場合は、次の手順に進みます。
  - インスタンスをシャットダウンする必要がない場合は、[カスタムイメージの作成](#createOS) に進んでください。
2. インスタンスの管理画面で、実際に使用されているビューモードに従って操作します。
  - **リストビュー**：下図に示すように、ターゲットインスタンスの行の右側にある**さらに** &gt; *インスタンス状態** &gt; **シャットダウン**をクリックします。
![](https://main.qcloudimg.com/raw/cc0bb1c82b96cca94cb7c1c011b664a7.png)
  - **タブビュー**：下図に示すように、インスタンス詳細ページで**シャットダウン**をクリックします。
![](https://qcloudimg.tencent-cloud.cn/raw/bd0d10a80c75a653adee564105a9820b.png)


#### カスタムイメージの作成[](id:createOS)
1. インスタンスの管理画面で、実際に使用されているビューモードに従って操作します。
   - **リストビュー**：ターゲットインスタンスの行の右側にある**さらに** &gt; **イメージの作成**をクリックします。下図に示すとおりです：
   ![](https://main.qcloudimg.com/raw/8e3fc28e1a0b1e9e337ff72e34a9fd01.png)
   - **タブビュー**：画面の右上隅にある**その他の操作** &gt; **イメージの作成**を選択します。下図に示すとおりです：
   ![](https://qcloudimg.tencent-cloud.cn/raw/27d7f6f19bc115c501bb1157ebe37cab.png)
2. ポップアップ画面で構成を完了してください。
  - **イメージ名**と**イメージの説明**：名称と説明をカスタマイズします。
  - **タグ**：必要に応じてインスタンスのタグを追加できます。タグは、クラウドリソースの分類、検索、および集約に使用されます。 詳細については、[タグ](https://intl.cloud.tencent.com/document/product/651/13334)をご参照ください。
<dx-alert infotype="explain" title="">
システムディスクとデータディスクを含むカスタムイメージを作成するには、[チケットを送信](https://console.intl.cloud.tencent.com/workorder/category)してください。 
</dx-alert>
3. イメージの作成をクリックすると、作成が完了します。
左側のナビゲーションバーで **[イメージ](https://console.cloud.tencent.com/cvm/image)** をクリックすると、「イメージ」ページでイメージの作成の進行状況を確認できます。


#### カスタムイメージを利用したインスタンスの作成（オプション）
イメージの作成が完了すると、イメージリストで作成したイメージを選択し、右側にある**CVMインスタンスを作成**をクリックして、イメージと同じ構成のサーバーを購入できます。
![](https://main.qcloudimg.com/raw/2d64df77d16b3c26d275770e03a1caf1.png)

:::
::: \sAPI\s経由でカスタムイメージの作成
CreateImage APIを使用してカスタムイメージを作成することができます。詳細については、 [CreateImage](https://intl.cloud.tencent.com/document/product/213/33276)をご参照ください。
:::
</dx-tabs>

## ベストプラクティス

### データディスク上のデータ移行

新しいインスタンスを起動する同時に、元のインスタンスのデータディスクのデータを保持する必要がある場合、最初にデータディスクの[スナップショット](https://intl.cloud.tencent.com/document/product/362/31638)を作成してください。新しいインスタンスを起動する時に、このデータディスクのスナップショットを使用して新しいCBSデータディスクを作成します。
詳細については、[スナップショットを使用してクラウドディスクの作成](https://intl.cloud.tencent.com/document/product/362/5757)をご参照ください。
