CVM은 취약한 비밀번호와 오픈소스 모듈 취약점으로 인해 해커의 침입을 받을 수 있습니다. 본문은 CVM이 바이러스의 침입을 받았는지 판단 방법과 해결 방법에 대해 설명합니다.

## 문제 파악
 [SSH 방식](https://intl.cloud.tencent.com/document/product/213/32501) 또는 [VNC 방식](https://intl.cloud.tencent.com/document/product/213/32494)으로 인스턴스에 로그인한 후 다음 방법을 사용하여 CVM이 바이러스에 감염되었는지 확인합니다.


<dx-accordion>
::: rc.local에 악성 명령 추가됨
다음 명령을 실행하여 `rc.local` 파일을 확인합니다.
```
cat /etc/rc.local 
```
출력 정보가 ​​'wget xx' 및 '/tmp/xx' 등 업무 또는 공지 이미지에 추가된 명령어가 아닌 경우, CVM은 바이러스의 침입을 받았을 가능성이 높습니다.

:::
::: crontab에 악성 작업 추가됨

다음 명령을 실행하여 현재 일정을 나열합니다.
```
crontab -l
```
출력 정보가 ​​'wget xx' 및 '/tmp/xx' 등 업무 또는 공지 이미지에 추가된 명령어가 아닌 경우, CVM은 바이러스의 침입을 받았을 가능성이 높습니다.

:::
::: ld.so.preload 동적 라이브러리 하이재킹 추가
다음 명령을 실행하여 `/etc/ld.so.preload` 파일을 확인합니다.
```
cat /etc/ld.so.preload
```
출력 정보가 ​​업무 외 추가된 동적 라이브러리인 경우, CVM은 바이러스의 침입을 받았을 가능성이 높습니다.

:::
::: sysctl.conf 대용량 페이지 메모리 설정
다음 명령어를 실행하여 대용량 페이지의 메모리 사용량을 확인합니다.
```
sysctl -a | grep "nr_hugepages "
```
출력이 0이 아니고 비즈니스 자체 프로그램이 대용량 페이지 메모리를 사용하지 않는다면 CVM은 바이러스의 침입을 받았을 가능성이 높습니다.

:::

</dx-accordion>

## 해결 단계
1. [스냅샷 생성](https://intl.cloud.tencent.com/document/product/362/5755)을 참고하여 시스템 데이터 백업을 완료하십시오.
2. [시스템 재설치](https://intl.cloud.tencent.com/document/product/213/4933)를 참고하여 인스턴스 시스템을 재설치하고, 보안 정책을 강화하기 위해 다음과 같은 조치를 취합니다.
 - CVM 비밀번호를 수정합니다. 비밀번호는 대문자, 소문자, 특수 부호, 숫자로 구성된 12-16자리의 복잡하고 임의적인 비밀번호로 설정하십시오. 자세한 내용은 [인스턴스 비밀번호 재설정](https://intl.cloud.tencent.com/document/product/213/16566)을 참조하십시오.
 - CVM에서 사용하지 않는 사용자를 삭제합니다.
 - sshd의 기본 포트 22를 1024-65525 사이의 자주 사용하지 않는 포트로 변경합니다. 자세한 방식은 [CVM 원격 기본 포트 수정](https://intl.cloud.tencent.com/document/product/213/35376)을 참조하십시오.
 - CVM과 연결된 보안 그룹의 규칙을 관리하기 위해서는 서비스와 프로토콜에 필요한 포트만 개방하면 되며, 모든 프로토콜과 포트를 개방하는 것은 권장하지 않습니다. 자세한 내용은 [보안 그룹 규칙 추가](https://intl.cloud.tencent.com/document/product/213/34272)를 참조하십시오.
 - 공용 네트워크에 핵심 애플리케이션 서비스 포트의 액세스를 개방하는 것은 권장하지 않습니다. 예시: mysql, redis 등 관련 포트를 로컬 액세스 또는 공인 네트워크 액세스 금지로 변경할 수 있습니다.
 - HS, yunsuo 등 보안 소프트웨어를 설치하고 실시간 알람을 추가하여 비정상적인 로그인 정보를 즉각적으로 수집할 수 있습니다.
