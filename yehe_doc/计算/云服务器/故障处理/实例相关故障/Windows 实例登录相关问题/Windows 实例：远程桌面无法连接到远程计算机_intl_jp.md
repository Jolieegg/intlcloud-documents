## 現象の説明
WindowsインスタンスへのWindowsリモート接続の適用時に、下図のような表示があらわれます。
![](https://main.qcloudimg.com/raw/8c79cadc3e14c9c4e0cbb5303b79f74a.png)

リモートデスクトップが以下のいずれかの原因でリモートコンピュータに接続できなくなっています。
1）サーバーのリモートアクセスを有効にしていない
2）リモートコンピュータがシャットダウンされている
3）ネットワーク上でリモートコンピュータが利用できなくなっている

リモートコンピュータを起動していること、ネットワークに接続していてリモートアクセスを有効にしていることを確認します。


## 考えられる原因

上記が表示された原因には次のものがあります（これらに限定されません。実際の状況に応じて分析を行ってください）。
- インスタンスが正常な実行状態にない
- パブリックIPがない、またはパブリックネットワーク帯域幅が0
- インスタンスをバインドしたセキュリティグループがリモートログインポートを開放していない（デフォルトでは3389）
- リモートデスクトップサービスを起動していない
- リモートデスクトップの設定に問題がある
- Windowsファイアウォールの設定に問題がある

## トラブルシューティングの手順


### インスタンスが実行状態かどうかをチェックする
1. [CVMコンソール](https://console.cloud.tencent.com/cvm/index)にログインします。
2. 下図のように、インスタンスの管理画面で、インスタンスが「実行中」かどうかを確認します。
![CVMリストページ](https://main.qcloudimg.com/raw/03cf75228bc468d2e436f876f229ebc9.png)
 - 「はい」の場合は、[サーバーがパブリックIPを設定しているかどうかをチェック](#step01)してください。
 - 「いいえ」の場合は、そのWindowsインスタンスを起動してください。


### サーバーがパブリックIPを設定しているかどうかをチェックする[](id:step01)
下図のように、サーバーがパブリックIPを設定しているかどうかをCVMコンソールでチェックします。
![パブリックIPなし](https://main.qcloudimg.com/raw/58c75d68372069652ec09ab93cfdbdc0.png)

 - 「はい」の場合は、[パブリックネットワーク帯域幅を購入しているかどうかをチェック](#step02)してください。
 - 「いいえ」の場合は、[Elastic IPを申請してバインド](https://intl.cloud.tencent.com/document/product/213/16586)してください。


###  パブリックネットワーク帯域幅を購入しているかどうかをチェックする[](id:step02)
パブリックネットワーク帯域幅が0Mbかどうかをチェックします（最少1Mbps）。
 - 「はい」の場合は、[ネットワークの調整](https://intl.cloud.tencent.com/document/product/213/15517)を参照し、帯域幅を5Mbps以上に調整することをお勧めします。
![](https://main.qcloudimg.com/raw/29b771d9de5d1ecdadb872c0378a31c7.png)
 - 「いいえ」の場合は、[インスタンスのリモートログインポート（3389）が開放されているかどうかをチェック](#step03)してください。


### インスタンスのリモートログインポート（3389）が開放されているかどうかをチェックする[](id:step03)
1. CVMコンソールのインスタンス管理ページで、ログインしたいインスタンスID/インスタンス名をクリックし、そのインスタンスの詳細ページに進みます。
2. 下図のように、**セキュリティグループ**タブで、インスタンスのセキュリティグループがリモートログインポート（デフォルトリモートデスクトップポート：3389）を開放しているかどうかをチェックします。
![セキュリティグループ](https://main.qcloudimg.com/raw/28b5f0a038dd354346745bd97f724350.png)
 - 「はい」の場合は、[リモートデスクトップサービスをチェック](#step04)してください。
 - 「いいえ」の場合は、対応するセキュリティグループルールを編集し、開放してください。操作方法については、[セキュリティグループルールの追加](https://intl.cloud.tencent.com/document/product/213/34272)をご参照ください。

### リモートデスクトップサービスをチェックする[](id:step04)
1. [VNCを使用してインスタンスにログイン](https://intl.cloud.tencent.com/document/product/213/32496)し、Windowsインスタンスのリモートデスクトップサービスが有効になっているかどうかをチェックします。
<dx-alert infotype="explain" title="">
 以下の操作はWindows Server 2016 OSのインスタンスを例に説明します。
</dx-alert>
2. <img src="https://main.qcloudimg.com/raw/6191c3ad8f212e7f8f6dddbbabd43f12.png" style="margin: -5px 0px;">を右クリックし、表示されたメニューから**システム**を選択します。
3. 表示された「システム」ウィンドウで、**高度なシステム設定**を選択します。
4. 表示された「システムのプロパティ」ウィンドウで、**リモート**タブを選択し、「このコンピュータへのリモート接続を許可する」にチェックが入っているかを確認します。
 - 「はい」の場合は、[ステップ5](#step04_5)を実行してください。
 - 「いいえ」の場合は、チェックを入れて**OK**をクリックしてください。
5. [](id:step04_5) <img src="https://main.qcloudimg.com/raw/6191c3ad8f212e7f8f6dddbbabd43f12.png" style="margin: -5px 0px;">を右クリックし、表示されたメニューから**コンピュータの管理**を選択します。
6. 表示された「コンピュータの管理」ウィンドウの左側メニューバーで、**サービスとアプリケーション** > **サービス**を選択します。
7. 右側のサービスリストで、**Remote Desktop Services**を起動しているかどうかをチェックします。
 - 「はい」の場合は、[ステップ8](#step04_8)を実行してください。
 - 「いいえ」の場合はサービスを起動してください。
8. [](id:step04_8) <img src="https://main.qcloudimg.com/raw/6191c3ad8f212e7f8f6dddbbabd43f12.png" style="margin: -5px 0px;">を右クリックし、表示されたメニューから**実行**を選択します。
9. ポップアップした「実行」ウィンドウで**msconfig**と入力し、**OK**をクリックします。
10. 表示された「システム設定」ウィンドウで、**正常に起動**にチェックが入っているかを確認します。
 - 「はい」の場合は、[Windowsインスタンスのシステム設定をチェック](#step05)してください。
 - 「いいえ」の場合は、チェックを入れて**OK**をクリックしてください。


### Windowsインスタンスのシステム設定をチェックする[](id:step05)
1. [VNCを使用してインスタンスにログイン](https://intl.cloud.tencent.com/document/product/213/32496)し、Windowsインスタンスのシステム設定のトラブルシューティングを行います。
<dx-alert infotype="explain" title="">
次の操作はWindows Server 2012 OSのインスタンスを例に説明します。
</dx-alert>
2. <img src="https://main.qcloudimg.com/raw/87d894e564b7e837d9f478298cf2e292.png" style="margin:-5px 0px;"></img>を右クリックし、表示されたメニューから**実行*を選択します。
3. ポップアップした「実行」に**services.msc**と入力し、**Enter**を押して「サービス」ウィンドウを開きます。
4. 下図のように、「Remote Desktop Services」のプロパティをダブルクリックし、リモートデスクトップサービスを起動しているかどうかをチェックします。
![Remote Desktop Service](https://main.qcloudimg.com/raw/6c781636c69eacae76a08b88f9e32b99.png)
 - 「はい」の場合は、[ステップ5](#step05_5)を実行してください。
 - 「いいえ」の場合は、「起動のタイプ」を「自動」に設定し、「サービスステータス」を「実行中」に設定します（**起動**をクリックするとサービスが起動します）。
5. [](id:step05_5)<img src="https://main.qcloudimg.com/raw/87d894e564b7e837d9f478298cf2e292.png" style="margin:-5px 0px;"></img>を右クリックし、表示されたメニューから**実行*を選択します。
6. ポップアップした「実行」ウィンドウに**sysdm.cpl**と入力し、**Enter**を押して、「システムのプロパティ」ウィンドウを開きます。
7. 下図のように、「リモート」タブで、リモートデスクトップの設定が「このコンピュータへのリモート接続を許可する(L)」となっているかどうかをチェックします。
![リモート設定](https://main.qcloudimg.com/raw/cbf2b2797bd48777008753f389574674.png)
 - 「はい」の場合は、[ステップ8](#step05_8)を実行してください。
 - 「いいえ」の場合は、リモートデスクトップを「このコンピュータへのリモート接続を許可する(L)」に設定してください。
8. [](id:step05_8)<img src="https://main.qcloudimg.com/raw/87d894e564b7e837d9f478298cf2e292.png" style="margin:-5px 0px;"></img>をクリックし、**コントロールパネル**を選択し、コントロールパネルを開きます。
9. 「コントロールパネル」で、**システムとセキュリティ** > **Windowsファイアウォール**を選択し、「Windowsファイアウォール」を開きます。
10. 下図のように、「Windowsファイアウォール」でWindowsファイアウォールの状態をチェックします。
![Windowsファイアウォールの状態](https://main.qcloudimg.com/raw/e74937594a03c141e6e5ac753f025d91.png)
 - 「有効」な状態であれば、[ステップ11](#step05_11)を実行してください。
 - 「無効」な状態であれば、[オンラインサポート](https://console.intl.cloud.tencent.com/workorder/category)を通してフィードバックします。
11. [](id:step05_11)「Windowsファイアウォール」で**Windowsファイアウォールによるアプリケーションの許可**をクリックし、「許可されたアプリケーション」ウィンドウを開きます。
12. 下図のように、「許可されたアプリケーション」ウィンドウで、「許可されたアプリケーションおよび機能(A)」の「リモートデスクトップ」にチェックが入っているかどうかを確認します。
![リモートデスクトップにチェックを入れる](https://main.qcloudimg.com/raw/dfed8792ce1dd8b32bee4aaa02ef6bbf.png)
 - 「はい」の場合は、[ステップ13](#step05_13)を実行してください。
 - 「いいえ」の場合は、「リモートデスクトップ」にチェックを入れ、「リモートデスクトップ」を有効にしてください。
13. [](id:step05_13)「Windowsファイアウォール」で**Windowsファイアウォールの有効化または無効化**をクリックし、「設定のカスタマイズ」ウィンドウを開きます。
14. 下図のように、「設定のカスタマイズ」ウィンドウで、「プライベートネットワークの設定」と「パブリックネットワークの設定」を「Windowsファイアウォールを無効にする（非推奨）」に設定します。
![無効化](https://main.qcloudimg.com/raw/5d5f8c4d7b783bc1018e03368ae400bc.png)

上記の操作を実行しても、リモートデスクトップによってWindowsインスタンスに接続できない場合は、[オンラインサポート](https://console.intl.cloud.tencent.com/workorder/category) に連絡してフィードバックしてください。



