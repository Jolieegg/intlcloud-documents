## 현상 설명
VNC로 CVM에 로그인할 때 비밀번호를 정확히 입력했는데도 로그인이 안되고 잠시 후 “Hint: Caps Lock on”이라는 오류 메시지가 나타납니다. 다음 이미지를 참고하십시오.
![](https://main.qcloudimg.com/raw/345dfc1dbe0c44d8836c94b6637ef4b0.png)
또한 SSH로 원격 로그인시 “Permission denied,please try again.”이라는 오류 메시지가 나타납니다. 다음 이미지를 참고하십시오.
![](https://main.qcloudimg.com/raw/db09e73d2a057fb8b297ffd31bf67b62.png)

## 예상 원인
잦은 무차별 대입 공격으로 인하여 `/var/log/btmp` 로그 용량이 과도하게 늘어났을 가능성이 있습니다. 이 파일은 로그인 오류 로그를 기록하는 데 사용되며, 용량이 너무 크면 비정상적인 로그인으로 로그에 기록되어 정상적인 로그인이 불가합니다. 다음 이미지를 참고하십시오.
![](https://main.qcloudimg.com/raw/c19f9e57a67ce6b1ed30cee22af9964c.png)

## 해결 방법
1. [작업 순서](#ProcessingSteps)를 참조하여 로그 파일 `/var/log/btmp` 의 용량이 너무 크지 않은지 확인합니다.
2. 무차별 대입 공격이 원인인지 확인하고 보안 정책을 강화합니다.

[](id:ProcessingSteps)

## 작업 순서

1. SSH를 사용하여 CVM에 로그인합니다. 자세한 내용은 [SSH를 사용해 Linux 인스턴스에 로그인](https://intl.cloud.tencent.com/document/product/213/32501)을 참조하십시오.
	- 로그인에 성공하면 다음 단계를 실행합니다.
	- 로그인에 실패하면 단독 사용자 모드를 사용해야 합니다.
2. `/var/log`로 들어가 로그 파일 `/var/log/btmp`의 용량을 확인합니다.
3. 로그 파일 `/var/log/btmp`의 용량이 너무 크면 다음 명령어를 실행하여 btmp 로그 내용을 비웁니다. 로그 파일을 비우고 나면 다시 로그인이 가능합니다.
```
cat /dev/null > /var/log/btmp
```
5. 계정 잠김이 사용자의 조작 오류 때문인지 무차별 대입 공격 때문인지 확인합니다. 무차별 대입 공격이 원인인 경우 다음과 같은 방법으로 보안 정책을 강화하시기 바랍니다.
	- CVM 비밀번호를 수정합니다. 비밀번호는 대문자, 소문자, 특수 부호, 숫자로 구성된 12-16자리의 복잡하고 임의적인 비밀번호로 설정하십시오. 자세한 내용은 [인스턴스 비밀번호 재설정](https://intl.cloud.tencent.com/document/product/213/16566)을 참조하십시오.
	- CVM에서 사용하지 않는 사용자를 삭제합니다.
	- sshd의 기본 포트 22를 1024-65525 사이의 자주 사용하지 않는 포트로 변경합니다. 자세한 방식은 [CVM 원격 기본 포트 수정](https://intl.cloud.tencent.com/document/product/213/35376)을 참조하십시오.
	- CVM과 연결된 보안 그룹의 규칙을 관리하기 위해서는 서비스와 프로토콜에 필요한 포트만 개방하면 되며, 모든 프로토콜과 포트를 개방하는 것은 권장하지 않습니다. 자세한 내용은 [보안 그룹 규칙 추가](https://intl.cloud.tencent.com/document/product/213/34272)를 참조하십시오.
	- 공용 네트워크에 핵심 애플리케이션 서비스 포트의 액세스를 개방하는 것은 권장하지 않습니다. 예시: mysql, redis 등 관련 포트를 로컬 액세스 또는 공인 네트워크 액세스 금지로 변경할 수 있습니다.
	- HS, yunsuo 등 보안 소프트웨어를 설치하고 실시간 알람을 추가하여 비정상적인 로그인 정보를 즉각적으로 수집할 수 있습니다.
