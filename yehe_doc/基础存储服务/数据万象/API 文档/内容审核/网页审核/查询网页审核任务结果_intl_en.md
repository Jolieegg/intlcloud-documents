## Feature Description

This API is used to query the result of a specified webpage moderation job. The webpage moderation feature is async. You can submit a job to moderate your webpage files, and then use the API for querying webpage moderation job result to query the moderation results.

>? Webpage moderation results are retained for three months, so you can query moderation results in the past three months through this API.
> 


## SDK Recommendation

CI SDK provides complete capabilities of demo, automatic integration, and signature calculation. You can easily and quickly call APIs through the SDK. For more information, see [SDK Overview](https://intl.cloud.tencent.com/document/product/1045/45578).

## Request

#### Sample request

```plaintext
GET /webpage/auditing/<jobId> HTTP/1.1
Host: <BucketName-APPID>.ci.<Region>.myqcloud.com
Date: <GMT Date>
Authorization: <Auth String>
```

>? 
> - Authorization: Auth String (for more information, see [Request Signature](https://intl.cloud.tencent.com/document/product/436/7778)).
> - When this feature is used by a sub-account, relevant permissions must be granted. For more information, see [Authorization Granularity Details](https://intl.cloud.tencent.com/document/product/1045/49896).
> 

#### Request headers

This API only uses common request headers. For more information, see [Common Request Headers](https://intl.cloud.tencent.com/document/product/1045/43609).

#### Request body

This request does not have a request body.

## Response

#### Response headers

This API only returns common response headers. For more information, see [Common Response Headers](https://intl.cloud.tencent.com/document/product/1045/43610).

#### Response body

The response body returns **application/xml** data. The following contains all the nodes:

```plaintext
<Response>
  <JobsDetail>
    <JobId></JobId>
    <State>Success</State>
    <Code>Success</Code>
    <Message>Success</Message>
    <Suggestion>1</Suggestion>
    <CreationTime></CreationTime>
    <Url></Url>
    <PageCount>3</PageCount>
    <Labels>
      <PornInfo>
        <HitFlag>1</HitFlag>
        <Score>96</Score>
      </PornInfo>
    </Labels>
    <ImageResults>
      <Results>
        <Url></Url>
        <Text></Text>
        <PornInfo>
          <HitFlag></HitFlag>
          <SubLabel></SubLabel>
          <Score></Score>
          <OcrResults>
            <Text></Text>
            <Keywords></Keywords>
            <Location>
              <X></X>
              <Y></Y>
              <Width></Width>
              <Height></Height>
              <Rotate></Rotate>
            </Location>
          </OcrResults>
        </PornInfo>
      </Results>
    </ImageResults>
    <TextResults>
      <Results>
        <Text></Text>
        <PornInfo>
          <HitFlag></HitFlag>
          <Score></Score>
          <Keywords></Keywords>
        </PornInfo>
      </Results>
    </TextResults>
  </JobsDetail>
</Response>
```

The nodes are as described below:

| Node Name (Keyword) | Parent Node | Description | Type |
| :----------------- | :----- | :----------------------- | :-------- |
| Response | None | Full information of the webpage moderation result. | Container |

`Response` has the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :----------------- | :------- | :----------------------------------------------------------- | :-------- |
| JobsDetail | Response | Details of the webpage moderation job. | Container |
| RequestId | Response | The ID automatically generated by the server for a request when the request is sent, which can help locate problems faster. | String |

`JobsDetail` has the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :----------------- | :------------------ | :----------------------------------------------------------- | :-------- |
| Code | Response.JobsDetail | Error code, which will be returned only if `State` is `Failed`. For more information, see [Error Codes](https://intl.cloud.tencent.com/document/product/1045/33700). | String |
| Message | Response.JobsDetail | Error message, which will be returned only if `State` is `Failed`. | String |
| JobId | Response.JobsDetail | ID of the webpage moderation job. | String |
| DataId | Response.JobsDetail | This field will return the original content if the `DataId` parameter is configured during job submission, which can contain up to 512 bytes. You can use this field to uniquely identify the data to be moderated in your business. | String |
| State              | Response.JobsDetail | Status of the webpage moderation job. Valid values: `Submitted`, `Success`, `Failed`, `Auditing`. | String |
| CreationTime       | Response.JobsDetail | Creation time of the webpage moderation job. | String |
| Url                | Response.JobsDetail | The URL of the file to be moderated, which will be returned if `Url` is selected during job creation. | String |
| Labels             | Response.JobsDetail | This field is used to return the **maliciousness tag with the highest priority** in the detection result, which represents the moderation result suggested by the model. We recommend you handle different types of violations and suggestions based on your business needs. Returned values: `Normal`, `Porn`, `Ads`, and other types of unsafe or inappropriate content. | Container |
| Suggestion         | Response.JobsDetail | This field indicates the moderation result. You can perform subsequent operations based on the result. We recommend you handle different results based on your business needs. Valid values: `0` (normal), `1` (sensitive), `2` (suspiciously sensitive, with human review recommended). | Integer |
| Label              | Response.JobsDetail | This field is used to return the **maliciousness tag with the highest priority** in the detection result, which represents the moderation result suggested by the model. We recommend you handle different types of violations and suggestions based on your business needs. Returned values: `Normal`, `Porn`, and `Ads`. | String  |
| PageCount          | Response.JobsDetail | Webpage moderation submits the image links and text in the webpage for separated moderation. This field indicates the total number of links and text pages submitted for moderation. | Integer |
| ImageResults       | Response.JobsDetail | Image moderation result of the webpage.                                       | Container |
| TextResults        | Response.JobsDetail | Text moderation result of the webpage.                                       | Container |
| HighlightHtml      | Response.JobsDetail | Highlighted HTML webpage content containing non-compliant keywords, which will be returned if `ReturnHighlightHtml` is specified in the request. | String |
| UserInfo           | Response.JobsDetail | Business field. This field will not exist if `UserInfo` is not set during job creation.                           | Container |
| ListInfo           | Response.JobsDetail | Blocklist/Allowlist status of the account.                                          | Container       |

`Labels` has the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| ------------------ | -------------------------- | -------------------------------------- | --------- |
| PornInfo           | Response.JobsDetail.Labels | The moderation result of the **pornographic information** moderation scene. | Container |
| AdsInfo            | Response.JobsDetail.Labels | The moderation result of the **advertising information** moderation scene. | Container |

`PornInfo` and `AdsInfo` have the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :----------------- | :------------------------------- | :----------------------------------------------------------- | :------ |
| HitFlag            | Response.JobsDetail.Labels.*Info | The moderation result returned for the moderation scene. Returned values: `0` (normal); `1` (confirmed as a violation of the current scene); `2` (suspected as a violation of the current scene).   | Integer |
| Score              | Response.JobsDetail.Labels.*Info | The confidence the moderation result hits the moderation scene. Value range: 0â€“100. The higher the value, the more likely the content hits the currently returned moderation scene. For example, `Porn 99` means that the content is very likely to be pornographic.  | Integer |

`ImageResults` has the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :----------------- | :------------------------------- | :------------------------------------------------------ | :-------------- |
| Results            | Response.JobsDetail.ImageResults | Image moderation result of the webpage. If multiple images are moderated, multiple `Results` values will be returned. | Container Array |

`Results` has the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :----------------- | :--------------------------------------- | :----------------------------------------------------------- | :-------- |
| Url                | Response.JobsDetail.ImageResults.Results | URL of the moderated image on the webpage, at which you can view the image. It must be a standard URL. | String |
| Text               | Response.JobsDetail.ImageResults.Results | This field is used to return the OCR text recognition result of the current image. It will be returned only if text content detection is enabled in the moderation policy. | String |
| Label              | Response.JobsDetail.ImageResults.Results | This field is used to return the **maliciousness tag with the highest priority** in the detection result, which represents the moderation result suggested by the model. We recommend you handle different types of violations and suggestions based on your business needs. Returned values: `Normal`, `Porn`, and `Ads`. | String  |
| Suggestion         | Response.JobsDetail.ImageResults.Results | This field indicates the moderation result. You can perform subsequent operations based on the result. We recommend you handle different results based on your business needs. Valid values: `0` (normal), `1` (sensitive), and `2` (suspiciously sensitive, with human review recommended). | Integer |
| PornInfo           | Response.JobsDetail.ImageResults.Results | The moderation result of the **pornographic information** moderation scene.                           | Container |
| AdsInfo            | Response.JobsDetail.ImageResults.Results | The moderation result of the **advertising information** moderation scene.                       | Container |

`PornInfo` and `AdsInfo` have the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :----------------- | :--------------------------------------------- | :----------------------------------------------------------- | :-------------- |
| HitFlag            | Response.JobsDetail.ImageResults.Results.*Info | The moderation result returned for the moderation scene. Returned values: `0` (normal); `1` (confirmed as a violation of the current scene); `2` (suspected as a violation of the current scene).   | Integer |
| Score              | Response.JobsDetail.ImageResults.Results.*Info | The confidence the moderation result hits the moderation scene. Value range: 0â€“100. The higher the value, the more likely the content hits the currently returned moderation scene. For example, `Porn 99` means that the content is very likely to be pornographic.  | Integer         |
| Category           | Response.JobsDetail.ImageResults.Results.*Info | This field indicates the specific moderation category hit; for example, `Sexy` presents the sexy category in the `Porn` tag. It may be null, indicating that no category is hit or there is no relevant category. | String |
| SubLabel           | Response.JobsDetail.ImageResults.Results.*Info | This field indicates the specific sub-tag hit by the moderation job; for example, `SexBehavior` is a sub-tag under the `Porn` tag. </br>Note: This field may return null, indicating that no specific sub-tags are hit. | String          |
| OcrResults         | Response.JobsDetail.ImageResults.Results.*Info | This field represents the detailed OCR result, including the text coordinate information and text recognition result. It will be returned if there is non-compliant content. | Container Array |
| LibResults         | Response.JobsDetail.ImageResults.Results.*Info | This field returns results based on recognition against the risk library. </br>Note: This field will not be returned if no samples in the risk library are hit.  | Container Array |

`LibResults` has the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :----------------- | :--------------------------------------------- | :----------------------------------------------------------- | :----- |
| ImageId            | Response.JobsDetail.ImageResults.Results.\*Info.LibResults | This field represents the hit image sample ID in the risk library.                     | String  |
| Score              | Response.JobsDetail.ImageResults.Results.\*Info.LibResults | This field returns the confidence under the current tag. Value range: 0â€“100.  The higher the value, the more likely the image hits a sample in the risk library.  For example, `Porn 99` means that the content is very likely to hit a pornographic sample in the library. | Integer |

`OcrResults` has the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :----------------- | :--------------------------------------------------------- | :----------------------------------------------------------- | :----------- |
| Text               | Response.JobsDetail.ImageResults.Results.\*Info.OcrResults | The specific text content recognized by OCR in the image.                          | String       |
| Keywords           | Response.JobsDetail.ImageResults.Results.\*Info.OcrResults | Keywords hit by the current moderation scene.                               | String Array |
| Location           | Response.JobsDetail.ImageResults.Results.\*Info.OcrResults | This parameter is used to return the position (X and Y coordinates of the top-left corner, length, width, and rotation angle) of the OCR detection frame in the image for quick location of the recognized text. | Container    |

`ObjectResults` has the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :----------------- | ------------------------------------------------------------ | :----------------------------------------------------------- | :-------- |
| Name               | Response.JobsDetail.ImageResults.Results.\*Info.ObjectResults | This field is used to return the name of the recognized object, such as person name.                 | String    |
| Location           | Response.JobsDetail.ImageResults.Results.\*Info.ObjectResults | This parameter is used to return the position (X and Y coordinates of the top-left corner, length, width, and rotation angle) of the recognition result in the image for you to quickly locate information. | Container |

`Location` has the following sub-nodes:

| Node Name (Keyword) | Description | Type |
| :----------------- | :----------------------------------------------------------- | :---- |
| X                  | This parameter is used to return the pixel position of the **abscissa (X) of the top-left corner** of the detection frame. It can be combined with other parameters to uniquely determine the size and position of the detection frame. | Float |
| Y                  | This parameter is used to return the pixel position of the **ordinate of the top-left corner** (Y) of the detection frame. It can be combined with other parameters to uniquely determine the size and position of the detection frame. | Float |
| Height             | This parameter is used to return the **height of the detection frame** (the length starting from the top-left corner and extending down the Y axis). It can be combined with other parameters to uniquely determine the size and position of the detection frame. | Float |
| Width              | This parameter is used to return the **width of the detection frame** (the length starting from the top-left corner and extending to the right on the X axis). It can be combined with other parameters to uniquely determine the size and position of the detection frame. | Float |
| Rotate             | This parameter is used to return the **rotation angle of the detection frame**. Valid values: **0â€“360** (**degrees**), and the direction is **counterclockwise rotation**. This parameter can be combined with the `X` and `Y` coordinate parameters to uniquely determine the specific position of the detection frame. | Float |

`TextResults` has the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :----------------- | :------------------------------ | :------------------------------------------------------ | :-------------- |
| Results            | Response.JobsDetail.TextResults | Text moderation result of the webpage. If multiple text segments are moderated, multiple `Results` values will be returned. | Container Array |

`Results` has the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :----------------- | :-------------------------------------- | :----------------------------------------------------------- | :-------- |
| Text               | Response.JobsDetail.TextResults.Results | Text on the webpage is divided into segments for moderation, each of which contains 10,000 UTF-8 characters. This parameter returns the text content of the current segment. | String  |
| Label              | Response.JobsDetail.TextResults.Results | This field is used to return the **maliciousness tag with the highest priority** in the detection result, which represents the moderation result suggested by the model. We recommend you handle different types of violations and suggestions based on your business needs. Returned values: `Normal`, `Porn`, and `Ads`. | String  |
| Suggestion         | Response.JobsDetail.TextResults.Results | This field indicates the moderation result. You can perform subsequent operations based on the result. We recommend you handle different results based on your business needs. Valid values: `0` (normal), `1` (sensitive), and `2` (suspiciously sensitive, with human review recommended). | Integer |
| PornInfo           | Response.JobsDetail.TextResults.Results | The moderation result of the **pornographic information** moderation scene.                           | Container |
| AdsInfo            | Response.JobsDetail.TextResults.Results | The moderation result of the **advertising information** moderation scene.                       | Container |

`PornInfo` and `AdsInfo` have the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :----------------- | :-------------------------------------------- | :----------------------------------------------------------- | :------ |
| HitFlag            | Response.JobsDetail.TextResults.Results.*Info | The moderation result returned for the moderation scene. Returned values: `0` (normal); `1` (confirmed as a violation of the current scene); `2` (suspected as a violation of the current scene).    | Integer |
| Score              | Response.JobsDetail.TextResults.Results.*Info | The confidence the moderation result hits the moderation scene. Value range: 0â€“100. The higher the value, the more likely the content hits the currently returned moderation scene. | Integer |
| Keywords           | Response.JobsDetail.TextResults.Results.*Info | Keywords hit in the current moderation scene. Multiple keywords are separated by comma.        | String  |
| LibResults         | Response.JobsDetail.TextResults.Results.*Info | This field returns results based on recognition against the risk library. </br>Note: This field will not be returned if no samples in the risk library are hit.  | Container Array |

`LibResults` has the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :----------------- | :-------------------------------- | :----------------------------------------------------------- | :----- |
| LibType            | Response.JobsDetail.TextResults.Results.\*Info.LibResults | Type of the hit risk library. Valid values: `1` (preset blocklist/allowlist library), `2` (custom risk library). | Integer      |
| LibName            | Response.JobsDetail.TextResults.Results.\*Info.LibResults | Name of the hit risk library. | String |
| Keywords           | Response.JobsDetail.TextResults.Results.\*Info.LibResults | Keywords hit in the library. There may be multiple returned values representing multiple hit keywords. | String Array |

`UserInfo` has the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type | Required |
| :----------------- | :--------------------- | :-------------------------------------------------- | :----- | :------- |
| TokenId            | Request.Input.UserInfo | Account information, which can contain up to 128 bytes.           | String | No       |
| Nickname           | Request.Input.UserInfo | Nickname information, which can contain up to 128 bytes.           | String | No       |
| DeviceId           | Request.Input.UserInfo | Device information, which can contain up to 128 bytes.           | String | No       |
| AppId              | Request.Input.UserInfo | Unique app ID, which can contain up to 128 bytes.           | String | No       |
| Room               | Request.Input.UserInfo | Room ID information, which can contain up to 128 bytes.           | String | No       |
| IP                 | Request.Input.UserInfo | IP address information, which can contain up to 128 bytes.           | String | No       |
| Type               | Request.Input.UserInfo | Business type, which can contain up to 128 bytes.           | String | No       |
| ReceiveTokenId     | Request.Input.UserInfo | User account to receive messages, which can contain up to 128 bytes.           | String | No       |
| Gender             | Request.Input.UserInfo | Gender information, which can contain up to 128 bytes.           | String | No       |
| Level              | Request.Input.UserInfo | Level information, which can contain up to 128 bytes.           | String | No       |
| Role               | Request.Input.UserInfo | Role information, which can contain up to 128 bytes.           | String | No       |

`ListInfo` has the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :---------------- | :--------------------------- | :------------------------------------------------------ | :----- |
| ListResults       | Response.JobsDetail.ListInfo | Results in all hit lists.                      | Container Array |

`ListResults` has the following sub-nodes:

| Node Name (Keyword) | Parent Node | Description | Type |
| :---------------- | :--------------------------------------- | :------------------------------------------------------ | :----- |
| ListType          | Response.JobsDetail.ListInfo.ListResults | Type of the hit list. Valid values: `0` (allowlist), `1` (blocklist). | Integer |
| ListName          | Response.JobsDetail.ListInfo.ListResults | Name of the hit list.                                          | String |
| Entity            | Response.JobsDetail.ListInfo.ListResults | Entity hit in the list.                                   | String |

#### Error codes

There are no special error messages for this request. For common error messages, see [Error Codes](https://intl.cloud.tencent.com/document/product/1045/33700).

## Samples

#### Request

```plaintext
GET /webpage/auditing/vab1ca9fc8a3ed11ea834c525400863904 HTTP/1.1
Accept: */*
Authorization: q-sign-algorithm=sha1&q-ak=AKIDZfbOAo7cllgPvF9cXFrJD0a1ICvR****&q-sign-time=1497530202;1497610202&q-key-time=1497530202;1497610202&q-header-list=&q-url-param-list=&q-signature=28e9a4986df11bed0255e97ff90500557e0e****
Host: examplebucket-1250000000.ci.ap-beijing.myqcloud.com
```

#### Response

```plaintext
HTTP/1.1 200 OK
Content-Type: application/xml
Content-Length: 666
Connection: keep-alive
Date: Tue, 09 Nov 2021 01:56:09 GMT
Server: tencent-ci
x-ci-request-id: NTk0MjdmODlfMjQ4OGY3XzYzYzhf****

<Response>
  <JobsDetail>
    <CreationTime>2021-11-09T10:03:32+08:00</CreationTime>
    <HighlightHtml>xxxxx</HighlightHtml>
    <ImageResults>
      <Results>
        <AdsInfo>
          <HitFlag>0</HitFlag>
          <Score>0</Score>
          <SubLabel/>
        </AdsInfo>
        <Label>Porn</Label>
        <PornInfo>
          <HitFlag>1</HitFlag>
          <Score>99</Score>
          <SubLabel>ACGPorn</SubLabel>
        </PornInfo>
        <Suggestion>1</Suggestion>
        <Text>xxxxxxx</Text>
        <Url>xxxxxx</Url>
      </Results>
    </ImageResults>
    <JobId>sh3dba0967410111eca1f1525400276c76</JobId>
    <Label>Porn</Label>
    <Labels>
      <AdsInfo>
        <HitFlag>0</HitFlag>
        <Score>0</Score>
      </AdsInfo>
      <PornInfo>
        <HitFlag>1</HitFlag>
        <Score>99</Score>
      </PornInfo>
    </Labels>
    <PageCount>2</PageCount>
    <State>Success</State>
    <Suggestion>1</Suggestion>
    <TextResults>
      <Results>
        <AdsInfo>
          <HitFlag>0</HitFlag>
          <Keywords/>
          <Score>0</Score>
        </AdsInfo>
        <Label>Porn</Label>
        <PornInfo>
          <HitFlag>1</HitFlag>
          <Keywords>xxxx</Keywords>
          <Score>98</Score>
        </PornInfo>
        <Suggestion>1</Suggestion>
        <Text>xxxx</Text>
      </Results>
    </TextResults>
    <Url>https://xxxx</Url>
  </JobsDetail>
  <RequestId>NjE4OWQ3MDNfY****RfMzQ0OF9h</RequestId>
</Response>
```

