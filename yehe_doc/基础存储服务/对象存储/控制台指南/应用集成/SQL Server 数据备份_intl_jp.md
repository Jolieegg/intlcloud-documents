## 概要

SQL Serverデータのバックアップは、Tencent CloudのCloud Object Storage(COS)が提供する[Serverless Cloud Function（SCF）](https://intl.cloud.tencent.com/document/product/583)をベースとしたデータベースバックアップ機能です。ユーザーがSQL Serverクラウドデータベースのバックアップファイルをオブジェクトストレージにダンプして永続的に保存できるように支援し、データの損失や破損を防ぐことができます。ユーザーが指定したバケットにバックアップ関数ルールを設定すると、SCFはユーザーServerのバックアップファイルを定期的にスキャンして、ファイルをバケットにダンプします。

## 注意事項

- SQL Serverデータのバックアップ関数は、Tencent CloudのSQL Serverデータベースのバックアップファイルをバックアップします。SQL Serverデータベースのバックアップを有効化したことがない場合、バックアップ関数を実行することはできません。Tencent CloudのSQL Serverデータベースのバックアップの詳細については、[TencentDB for SQL Serverのバックアップ](https://cloud.tencent.com/document/product/238/43296)をご参照ください。
- 以前にCOSコンソールでバケットにSQL Serverデータのバックアップルールを追加したことがある場合は、[SCFコンソール](https://console.cloud.tencent.com/scf/list?rid=1&ns=default)で、作成したSQL Serverデータのバックアップ関数を確認できます。この関数を削除すると、ルールが有効にならない場合がありますので削除**しないで**ください。
- SQL Serverデータのバックアップは、広州、上海、北京、成都、中国香港、シンガポール、ムンバイ、トロント、シリコンバレーなど、SCFがリリースされているすべてのリージョンでサポートされています。サポートされているリージョンについては、[SCF製品ドキュメント](https://intl.cloud.tencent.com/document/product/583)をご参照ください。

## 操作手順

1. [COSコンソール](https://console.cloud.tencent.com/cos5)にログインします。
2. 左側ナビゲーションで**アプリケーション統合 > データバックアップ**をクリックし、アプリケーション統合の管理ページに進みます。
3. **SQL Serverデータのバックアップ**を見つけて**バックアップルールの設定**をクリックし、ルール設定ページに進みます。
4. **関数の追加**をクリックします。
>! SCFサービスをアクティブ化していない場合は、[SCFコンソール](https://console.cloud.tencent.com/scf)に移動してSCFサービスをアクティブ化し、プロンプトに従ってサービス権限承認を行えば完了です。
>
5. ポップアップしたウィンドウで、以下の情報を設定します。
<table>
   <tr>
      <th><b>関数名</b></td>
      <td>関数の一意の識別名として、作成後に変更することはできません。<a href="https://console.cloud.tencent.com/scf/list?rid=1&ns=default">SCFコンソール</a> でこの関数を確認できます。</td>
   <tr>
     <th><b>関連バケット</b></td>
      <td> SQL Serverバックアップファイルを格納するバケットです。</td>
         </tr>
<th>トリガーサイクル</b></td>
      <td>SQL Serverデータのバックアップ関数は、時限式トリガーでバックアップ・ダンプ操作をトリガーします。トリガーサイクルは、日次・週次・カスタムサイクルに対応します。</td>
   <tr>
      <th nowrap="nowrap"><b>Cron表現</b></td>
      <td>トリガーサイクルがカスタムに設定されている場合、Cronを使用して具体的なトリガーサイクルルールを指定することができます。Cronは現在、現地標準時で実行されています。詳細な設定ポリシーについては、<a href="https://cloud.tencent.com/document/product/583/9708#cron-.E8.A1.A8.E8.BE.BE.E5.BC.8Ft"> Cron関連ドキュメント</a>をご参照ください。</td>
   <tr>
   <th><b>データベースインスタンス</b></td>
      <td>現在のバケットがあるリージョンのSQL Serverデータベースインスタンスのリストです。</td>
   <tr>
      <th><b>配布パス</b></td>
      <td>バックアップファイルの配布パスのプレフィックスは、入力しないとデフォルトでバケットルートパスに保存されます。</td>
   <tr>
      <th><b>SCF権限承認</b></td>
      <td>SQL Serverデータベースのバックアップには、SCFがお客様のSQL Serverバックアップからデータベースインスタンスとそのバックアップファイルを読み取り、お客様が指定したバケットにダンプするための権限承認が必要です。そのため、この権限承認を追加する必要があります。</td>
         </tr>
</table>

6. 設定を追加して**確定**をクリックすると、関数が追加されたことを確認できます。
新規作成した関数に対しては、次のような操作が可能です。
 - **ログ**をクリックして、SQL Serverデータのバックアップ履歴を確認します。バックアップでエラーが発生した場合は、**ログ**をクリックしてSCFコンソールにすばやくジャンプし、ログエラーの詳細を確認することもできます。
 - **その他 > 編集**をクリックして、SQL Serverデータのバックアップルールを変更します。
 - **その他 > 削除**をクリックして、使用しないSQL Serverデータのバックアップルールを削除します。
