## 소개

파일 병합은 Tencent Cloud Cloud Object Storage(COS)가 [Serverless Cloud Function](https://www.tencentcloud.com/document/product/583)을 기반으로 사용자에게 제공하는 파일 내용 병합 기능입니다. 파일 내용 병합 기능은 COS 상의 여러 파일의 이진법 내용을 지정된 순서대로 병합하여 새로운 파일을 생성합니다.

사용자가 버킷에 파일 병합 규칙을 추가한 후, 병합 파일의 URLs를 지정하고, SCF 함수를 트리거하여 파일 콘텐츠 병합 동작을 수행하고, 병합된 파일을 버킷의 지정된 경로로 전송해야 합니다.


## 주의 사항

- 병합된 새 파일의 최대 크기는 50TB입니다.
- 이 기능은 파일의 이진법 내용만 병합하며, 오디오 및 비디오 스티칭 및 이미지 스티칭에는 사용될 수 없습니다.
- COS 콘솔에서 버킷에 파일 병합 규칙을 추가한 적이 있는 경우, [SCF 콘솔](https://console.cloud.tencent.com/scf/list?rid=1&ns=default)에서 기존에 생성한 파일 병합 함수를 볼 수 있습니다. 이 함수를 삭제하지 **마십시오** 삭제할 경우 규칙이 적용되지 않을 수 있습니다.
- 광저우, 상하이, 베이징, 청두, 중국홍콩, 싱가포르, 뭄바이, 토론토, 실리콘밸리 등 SCF가 런칭된 리전은 파일 병합을 지원합니다. 리전에 대한 자세한 내용은 [SCF 제품 문서](https://www.tencentcloud.com/document/product/583)를 참고하십시오.
- 병합 과정 중 오류가 발생한 경우, 생성한 함수 오른쪽에 있는 **로그 조회**를 클릭하여 SCF 콘솔로 이동해 로그 오류 상세 정보를 확인할 수 있습니다.
- ARCHIVE 및 DEEP ARCHIVE 유형의 파일은 병합이 지원되지 않습니다. 이 유형의 파일 내용을 병합하려면 복구가 선행되어야 합니다. 복구 방법은 [아카이브된 객체 복구](https://intl.cloud.tencent.com/document/product/436/30961)를 참고하십시오.
- COS 문서 병합은 SCF 서비스에 종속되며, SCF 서비스는 사용자에게 [Free Tier](https://intl.cloud.tencent.com/document/product/583/12282)를 제공하고, 무료 한도를 초과한 부분에 대해서는 [SCF Pricing](https://intl.cloud.tencent.com/document/product/583/12281)에 따라 과금합니다. 병합하는 파일 내용이 많고 클수록 더 많은 리소스 사용량이 소모됩니다. 병합 횟수가 많을수록 더 많은 호출 횟수가 소모됩니다.

## 작업 단계

1. [COS 콘솔](https://console.cloud.tencent.com/cos5)에 로그인합니다.
2. 왼쪽 사이드바에서 **애플리케이션 통합 > 확장 기능**을 클릭하고, **파일 병합**을 찾습니다.
3. **API 액세스 구성**을 클릭하여 **파일 병합** 구성 페이지로 이동합니다.
>! SCF를 활성화하지 않은 경우 [SCF 콘솔](https://console.cloud.tencent.com/scf)로 이동하여 SCF 서비스를 활성화하고 안내에 따라 서비스 라이선스를 완료합니다.
>
4. **함수 추가**를 클릭한 후, 팝업창에서 다음 정보를 설정합니다.
 - **함수 이름**: 함수 이름은 함수의 고유한 식별자로, 생성 후에는 수정할 수 없습니다. [SCF 콘솔](https://console.cloud.tencent.com/scf/list?rid=1&ns=default)에서 해당 함수를 확인할 수 있습니다.
 - **실행 설정**: 해당 함수의 실행 방식을 선택하고 동기화 실행을 선택하면 병합 작업이 실행된 후 함수가 응답하고 실행 결과를 반환합니다. 비동기화 실행을 선택하면 함수가 직접적으로 응답하고 백그라운드에서 병합 작업을 계속 수행합니다.
 ![img](https://qcloudimg.tencent-cloud.cn/raw/bebd7661688228c917c8e33e2eee2021.png)
 - **인증 방법**: 해당 함수의 인증 방법을 선택합니다.
    - SCF 인증을 선택할 경우, 해당 함수에 대한 호출 권한이 있는 ID를 통해 함수를 트리거해야 합니다.
    - 인증 면제를 선택할 경우, 요청을 수신할 적절한 API 게이트웨이를 선택해야 합니다. 해당 리전에 API 게이트웨이가 없는 경우, **신규 API 게이트웨이 서비스**를 선택하면 선택한 리전에 해당 함수 요구 조건에 부합한 API 게이트웨이를 구성해드립니다. 
 - **게이트웨이 서비스/API 경로/요청 방법**: API 게이트웨이 설정 관련 자세한 설명은 [API 게이트웨이 제품 개요](https://intl.cloud.tencent.com/document/product/628/11755)를 참고하십시오.
 - **SCF 권한 부여**: 파일 내용 병합을 위해서는 SCF가 버킷에서 해당 파일을 읽고, 병합 후 새로운 파일을 지정한 위치에 업로드할 수 있는 권한을 부여해야 합니다. SCF 서비스에 권한을 부여하려면 해당 항목을 선택하십시오.
5. 설정 추가하고 **확인** 클릭 후, 일정 시간이 지나면 함수가 추가된 것을 확인할 수 있습니다.
![](https://qcloudimg.tencent-cloud.cn/raw/7da27a3179c3b061e9063eaa8265d0d6.png)
6. **사용 가이드**를 클릭하여 해당 함수에 대해 설정해야 하는 매개변수 필드에 대한 설명을 확인합니다. 이 중 본문 콘텐츠 매개변수는 json 형식으로 전달되며, 설정 예시는 [API를 통한 파일 병합](https://intl.cloud.tencent.com/document/product/436/42533)을 참고하시기 바랍니다.
![](https://qcloudimg.tencent-cloud.cn/raw/ce8b8c37806c09fff61a9d39f587e5fa.png)
7. **다음 단계**를 클릭하여 호출 테스트 페이지로 이동합니다.
8. **호출**을 클릭하면 콘솔이 이전 단계에서 구성한 매개변수에 따라 해당 함수에 대해 호출을 시작하고 **응답 결과**에서 함수의 응답 결과를 볼 수 있습니다.
![](https://qcloudimg.tencent-cloud.cn/raw/f0b9865f0fc56f17dcb6926d12fffd3a.png)
9. 새로 생성한 함수에 다음과 같은 작업을 진행할 수 있습니다.
 - **로그**를 클릭하여 파일 병합 함수 실행 이력을 확인합니다. 함수에 오류가 발생한 경우, **로그**를 클릭하여 SCF 콘솔로 빠르게 이동해 로그 오류 상세 정보를 확인할 수 있습니다.
 - **더 보기 > 편집**을 클릭하여 파일 병합 규칙을 수정합니다.
 - **더 보기 > 삭제**를 클릭하여 더 이상 필요하지 않은 파일 병합 함수를 삭제합니다.


