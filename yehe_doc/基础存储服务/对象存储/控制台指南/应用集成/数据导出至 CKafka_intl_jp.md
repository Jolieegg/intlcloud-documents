## 概要

CKafkaへのデータエクスポートは、Tencent CloudのCloud Object Storage（COS）が提供する[Serverless Cloud Function（SCF）](https://www.tencentcloud.com/document/product/583)をベースとした、データレイクからデータを抽出するためのソリューションです。ユーザーがCSV、JSON 等のファイル形式のデータを、同じリージョンのTencent Cloud CKafkaサービスにエクスポートすることを支援し、大量のメッセージ、ログデータの集計分析を行います。

## 注意事項

- CKafkaへのデータエクスポート機能は、COSデータ検索インターフェースに関連しています。制限に関する説明については、[Selectの概要](https://intl.cloud.tencent.com/document/product/436/32472)をご参照ください。
- 以前にCOSコンソールでバケットにCKafkaへのデータエクスポートルールを追加したことがある場合は、[SCFコンソール](https://console.cloud.tencent.com/scf/list?rid=1&ns=default)で、作成したCKafkaへのデータエクスポート関数を確認できます。このCKafkaへのデータエクスポート関数を削除、あるいは変更すると、ルールが有効にならない場合がありますので削除**しないで**ください。
- 現在、CKafkaへのデータエクスポート機能は、広州、上海、北京、成都でのみサポートされています。
- COSのCKafkaへのデータエクスポート機能は、SCFサービスに依存しており、ユーザーには[無料利用枠](https://intl.cloud.tencent.com/document/product/583/12282)が提供されていますが、無料利用枠を超える部分については、[SCF製品価格](https://intl.cloud.tencent.com/document/product/583/12281)に従って課金されます。

## 操作手順

1. [COSコンソール](https://console.cloud.tencent.com/cos5)にログインします。
2. 左側ナビゲーションで**アプリケーション統合 > データエクスポート**をクリックし、**CKafkaへのデータエクスポート**を見つけます。
3. **ルールの設定**をクリックし、ルール設定ページに進みます。
4. **関数の追加**をクリックします。
>! SCFサービスをアクティブ化していない場合は、[SCFコンソール](https://console.cloud.tencent.com/scf)に移動してSCFサービスをアクティブ化し、プロンプトに従ってサービス権限承認を行えば完了です。
>
5. ポップアップしたウィンドウで、以下の情報を設定します。
![](https://qcloudimg.tencent-cloud.cn/raw/46de1cee616ab7e4dcf344c4598725db.png)
   - **関数名のプレフィックス**：関数の一意の識別名として、作成後に変更することはできません。[SCFコンソール](https://console.cloud.tencent.com/scf/list?rid=1&ns=default)でこの関数を確認できます。
   - **シナリオの選択**：エクスポートしたいログソースを選択します。COSログファイルでのエクスポートを推奨します。
   - **ソースバケット**：ログを保存するバケットの名称です。COSログファイルを選択してエクスポートする場合は、先にCOSログストレージ機能を有効にする必要があります。
   - **ログストレージの状態**：ログストレージの状態が有効になっているかどうかの確認が必要です。
   - **バケットへの配信**：ログが保存されるバケットです。
   - **ログ配信のプレフィックス**：ログを見つけやすくするために、パスプレフィックスを入力します。
   - **SCF権限承認**：CKafkaへのデータエクスポートは、SCFがバケットからログファイルを読み取るための承認が必要です。そのため、この権限を追加する必要があります。
6. **プリセットパラメータを入力**をクリックし、CKafkaへのデータエクスポートを設定します。設定項目の説明は次のとおりです。
![](https://qcloudimg.tencent-cloud.cn/raw/bf08c9eac65f58fd6beb5f3afd7bb0be.png)
   - **アクセス方式**：CKafkaのアクセス方式です。VPCプライベートネットワークアクセスを選択する場合は、対応するVPCを入力してください。
   - **アドレスにアクセス**：CKafkaがアクセスするアドレスです 。
   - **トピック名**：作成したCKafkaのトピック名です。
   - **認証設定**：CKafkaの認証方式です。 **認証が必要**を選択する場合は、対応するユーザー名およびユーザーパスワードを入力してください。
   - **速度の上限**：CKafkaへのエクスポート速度の上限です。
7. 個別化されたログデータの抽出をする場合は、**前へ戻る**をクリックし、設定を行います。通常は、直接**確認**をクリックし、関数の追加を完了することを推奨します。
![](https://qcloudimg.tencent-cloud.cn/raw/9e1ba247fd0515f8d30b056dd728d874.png)
   新規作成した関数に対しては、次のような操作が可能です。
 - **ログ**をクリックして、CKafkaへのデータエクスポートの履歴を確認します。CKafkaへのデータエクスポートでエラーが発生した場合は、**ログ**をクリックしてSCFコンソールにすばやくジャンプし、ログエラーの詳細を確認することもできます。
 - **詳細**をクリックして、現在の関数の詳細設定を確認します。
 - **編集**をクリックして、CKafkaへのデータエクスポートのルールを変更します。
 - **トリガー**をクリックして、バケット内の既存のログを1つ選択し、CKafkaへのエクスポートを直接トリガーすることができます。
 - **削除**をクリックして、使用しないCKafkaへのデータエクスポートのルールを削除します。
