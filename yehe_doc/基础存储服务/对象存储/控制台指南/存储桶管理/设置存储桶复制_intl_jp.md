## 概要

バケットコピー機能を有効にすると、ソースバケットの**インクリメンタルオブジェクト**を別のリージョンのターゲットバケットに自動的かつ非同期的にコピーすることができます。ソースバケット内のオブジェクトに対して管理操作（例えばオブジェクトの追加や削除など）を実行すると、Cloud Object Storage（COS）は、これらの操作をターゲットバケットに自動的にコピーします。お客様は実際の必要性に応じて、バケットコピーの有効または無効を選択することができます。その他の情報については、[バケットコピーの概要](https://intl.cloud.tencent.com/document/product/436/19237)をご参照ください。

##  前提条件

バケットコピー機能を有効にする前に、ソースバケットとターゲットバケットの両方が、[バージョン管理の有効化](https://intl.cloud.tencent.com/document/product/436/19881)機能が有効になっていることを確認してください。

## 操作手順

### バケットコピーの有効化

1. [COSコンソール](https://console.cloud.tencent.com/cos5)にログインします。
2. 左側ナビゲーションバーで、**バケットリスト**をクリックします。
3. バケットコピーを設定したいソースバケットをクリックし、バケット詳細ページに進みます。
4. 左側の**障害復旧管理 > バケットコピー**をクリックします。
5. **バケットコピー**バーで、**ルールの追加**をクリックします。
![](https://main.qcloudimg.com/raw/910b0ddbe6f3bb0093544b5c21a07ca0.png)
6. ポップアップしたウィンドウで、バケットコピールールを設定し、**OK**をクリックします。
>? ソースバケットとターゲットバケットのどちらもバージョン管理機能が有効化されていない場合，まずバージョン管理機能を有効化してから、バケットコピールールを設定してください。
>
![](https://main.qcloudimg.com/raw/2a167db6422d4de507d3851d9965ab37.png)
設定項目の説明は次のとおりです。
<table>
	<tr><th style="width: 18%">設定項目</th><th>設定説明</th></tr>
	<tr><td>ソースリージョン</td><td>ソースバケットが所属するリージョンです。</td></tr>
	<tr><td>適用範囲</td><td>コピーしたいソースバケット内のオブジェクトの範囲です。設定していない場合は、デフォルトではバケット内のすべてのオブジェクトがコピーされます。プレフィックスが指定されている場合、特定のプレフィックスを持つコンテンツがコピーされます（例えば、`logs/`プレフィックスを持つファイルをコピーしたい場合は、`logs/`を入力します）。</td></tr>
	<tr><td>リソースパス</td><td>ソースバケットのパスです。</td></tr>
	<tr><td>ターゲットバケット</td><td>コピーされたオブジェクトを保存するバケットです。その所属リージョンは、ソースバケットのリージョンと同一にすることができます。同じリージョンでは1つのバケットのみがサポートされ、現在のアカウント以外のバケットを選択することはサポートされていません。</td></tr>
	<tr><td>ターゲットストレージタイプ</td><td>ターゲットバケットにコピーされたオブジェクトのストレージタイプです。デフォルトでは、ソースバケット内のオブジェクトのタイプに追従します。他のストレージタイプを選択して、ターゲットバケットにコピーされたオブジェクトのタイプを変更することができます。</td></tr>
	<tr><td>削除マーカーの同期</td><td>バージョン管理が有効な場合、バージョンIDを指定せずにファイルを削除すると、ソースバケットに削除マーカーが追加されます。削除マーカーの同期を選択した場合、バケットコピーはこのマーカーをターゲットバケットにコピーします。非同期を選択した場合、ターゲットバケットは削除マーカーを新たに追加しません。どちらの状況でも、ターゲットバケットは対応するファイルを削除せず、ユーザーはバージョンIDを指定してオブジェクトの旧バージョンにアクセスすることができます。バージョン管理と削除マーカーの詳細情報については、 <a href="https://intl.cloud.tencent.com/document/product/436/19883">バージョン管理の概要</a> のドキュメントをご参照ください。</td></tr>
</table>
>!
> - ルールの設定が完了すると、ルールに対して管理操作を実行することができます。ボタンをクリックすると現在のルールを有効または無効にでき、編集ボタンをクリックすると現在のルールを変更することができます。
> - バケットコピールールを最初に設定したときに、適用範囲をバケットのすべての内容をコピーするように設定した場合、新しいルールを追加することはできません。現在のルールを編集するか、現在のルールを削除して再度追加することで変更することができます。
> - バケットコピールールを最初に設定したときに、適用範囲をいずれかの項目のプレフィックスの内容に設定した場合でも、現在のルールを編集することで、バケットのすべての内容に適用範囲を変更できます。
> 

### バケットコピーの無効化

バケットコピー機能を無効化するには、ステータスボタンを無効にする、ルールを削除するという2種類の方法があります。

- **ステータスボタンの無効化による方法**：いずれかのルールのステータスボタンを無効にして、現在のルールを一時的に使用禁止にします。この操作により、現在のバケットコピー機能が一時停止され、コピーされたデータがターゲットバケット、ソースバケットに保持され、ソースバケットの増分データはターゲットバケットにコピーされなくなります。再度使用する場合は、有効化ボタンをクリックします。
- **ルールの削除**：**バケットコピー**の管理項目で、追加したルールを削除します。ルールを削除すると、設定したバケットコピールールは無効になり、コピーしたデータはターゲットバケットに保存され、ソースバケットの増分データは、バケットコピー操作を行わなくなります。再度使用する場合は、ルールをもう一度追加する必要があります。
![](https://main.qcloudimg.com/raw/f26250880b0f298531e66a49ccea8dc5.png)

>!
> - 完了していないバケットコピー操作は、バケットコピーが無効になると中止され、続行できなくなります。
> - バケットに対してバケットコピーを再度有効にすると、有効化が完了した後に追加されたオブジェクトに対してのみバケットコピー操作が実行されます。
> 

