## 概要

ここでは、COSの画像処理機能をコンソールから使用する方法についてご説明します。画像処理機能の使用方法には、以下2つの方法があります。画像処理の説明については、[画像処理の概要](https://intl.cloud.tencent.com/document/product/436/35280)をご参照ください。

- **画像URLからパラメータを追加**：画像のオブジェクトアドレス(URL)に対応するパラメータを追加することで、画像に応じた処理を行うことができます。
- **ピクチャースタイルの使用**：スタイルを作成することで異なる処理効果を保存した上で、スタイルを使用して画像を一元的に処理することができます。ここで設定するスタイルは、画像をダウンロードする際に、リアルタイム処理のパラメータに組み合わされるテンプレートです。

> !
> - 画像処理機能は、パブリッククラウドのリージョンでのみサポートされています。
> - 画像処理機能は課金項目で、Cloud Infiniteによって課金されます。詳細な課金方法については、Cloud Infiniteの[課金と価格](https://intl.cloud.tencent.com/document/product/1045/33431)をご参照ください。


## URLパラメータの追加

1. [COSコンソール](https://console.cloud.tencent.com/cos5/bucket)にログインします。
2. 画像があるバケットを見つけ、そのバケット名をクリックし、バケット管理ページに進みます。
3. 画像ファイル右側のアクションバーの下にある【詳細】をクリックして、ファイル詳細ページに進みます。
4. 【オブジェクトアドレス】をコピーして、ブラウザウィンドウのアドレスバーに貼り付けます。
> !画像を処理するには、オブジェクトの書き込み権限が必要です。オブジェクトの権限設定については、[オブジェクトのアクセス権限の設定](https://intl.cloud.tencent.com/document/product/436/13327)をご参照ください。
5. アドレスバーで、オブジェクトアドレスの後ろに次の形式によって対応するパラメータを追加します。 画像処理のパラメータと説明については、[Cloud Infiniteの基本的な画像処理](https://intl.cloud.tencent.com/document/product/1045/33694)のAPIドキュメントをご参照ください。
```sh
オブジェクトアドレス?処理インターフェース名/処理操作名/処理パラメータ
```
> !画像ファイルへのアクセス権限がプライベート読み取りの場合、署名のあるアドレスに画像処理パラメータを追加する必要があります。

**事例：画像の幅と高さを元画像の50%にスケーリングします**
元の画像効果が次のようになっていると仮定した場合、オブジェクトのアクセス権限はパブリック読み取りとプライベート書き込みになります。オブジェクトアドレスURLは、`https://examplebucket-1250000000.cos.ap-chengdu.myqcloud.com/sample.jpeg`です。
![img](https://main.qcloudimg.com/raw/3d4682ff8e622425ebd29913810a5c38.jpeg)

次に、URLリンクに以下のパラメータを追加します。

- スケーリング処理インターフェース：imageMogr2
- スケーリング操作名：thumbnail
- 処理パラメータ：!50p

パラメータを追加した後のアドレスは、`https://examplebucket-1250000000.cos.ap-chengdu.myqcloud.com/sample.jpeg?imageMogr2/thumbnail/!50p`です。このアドレスをアドレスバーに貼り付けてエンターキーを押すと、以下のようなスケーリングされた画像が表示されます。
![](https://main.qcloudimg.com/raw/f48dba67ddfac797136a552dc6a14816.jpg)

## ピクチャースタイルの使用

ピクチャースタイル機能は、異なる処理操作のパラメータをテンプレート形式で提示し、スタイルによって画像を一元的に処理できるようにするものです。ここで設定するスタイルは、画像をダウンロードする際に、リアルタイム処理のパラメータに組み合わされるテンプレートです。次に、**画像のスケーリングを幅480px、高さ270pxに制限するスタイル**を例として、設定方法をご説明します。


1. [COSコンソール](https://console.cloud.tencent.com/cos5/bucket)にログインします。
2. 画像があるバケットを見つけ、そのバケット名をクリックし、バケット管理ページに進みます。
3. 左側メニューバーで、【画像処理】をクリックし**スタイル管理**ページに進みます。
   **セパレータ**：スタイルセパレータは、ファイル名と処理スタイルを区切る記号で、ハイフン(-)、アンダーライン(_)、スラッシュ(/)および感嘆符(!)があります。ここでは、感嘆符(!)を選択してから保存します。
4. 【スタイルの追加】をクリックすると、以下の設定情報を含む**スタイルの追加**ページに進みます。
	- **スタイル名**：カスタマイズしたスタイル名を入力します。ここでは例として、「yunstyle」と入力します。
> ! 
> - スタイル名は大文字と小文字を区別する必要があり、保存後に変更することはできません。
> - 曖昧さを避けるため、現在有効な区切り識別子を処理スタイル名に含めないでください。
	- **編集モード**：基本編集を選択します。
  - サムネイル方式：スケーリングのみを選択します。
  - スケーリングの選択：幅と高さのスケーリングを限定して選択します。
  - スケーリングサイズ：幅480px、高さ270px。
  - プログレッシブ表示：オンにすると、画像にアクセスした場合、画像がプログレッシブ表示モードで表示されます。ここでは、デフォルトで無効となっています。
  - 出力形式：画像出力の形式を選択します。ここではデフォルトのオリジナル画像が保持されます。
5. 情報の設定が完了したら、右側のプレビューボタンをクリックすると、プレビューを確認できます。
6. プレビューが正しい場合は、【保存】をクリックすると、yunstyleという名前のピクチャースタイルが追加されていることが確認できます。
> ?
> - 同じバケットに最大100個のスタイルを設定できます。
> - 設定が有効になるまでの時間は平均30分です。
> - セパレータの変更にはキャッシュのクリアが必要で、ネットワーク全体で有効になるまでに少なくとも24時間かかります。
> - 使用済みのセパレータをキャンセルすると、製品機能に異常が発生する場合があります。
> - ピクチャースタイルの詳細については、[スタイルの設定](https://intl.cloud.tencent.com/document/product/1045/33443)をご参照ください。
7. オブジェクトの詳細ページに進み、オブジェクトアドレスをコピーして、オブジェクトアドレスの後に以下の形式でセパレータとスタイル名を追加します。
```
オブジェクトアドレス + セパレータ + 処理スタイル名
```
最終的に得られたオブジェクトのアドレスは、`https://examplebucket-1250000000.cos.ap-chengdu.myqcloud.com/sample.jpeg!yunstyle`です。このアドレスをアドレスバーに貼り付けてエンターキーを押すと、以下のようなスケーリングされた画像が表示されます。
![](https://main.qcloudimg.com/raw/f48dba67ddfac797136a552dc6a14816.jpg)
署名を付ける必要がある場合、URLは`https://examplebucket-1250000000.cos.ap-chengdu.myqcloud.com/sample.jpeg!yunstyle?q-sign-algorithm=<signature>`で、`/sample.jpg!yunstyle`をリソースとして、署名`<signature>`を計算します。


