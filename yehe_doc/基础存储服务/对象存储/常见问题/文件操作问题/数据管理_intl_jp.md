## 削除に関するご質問

### コンソールでバケットを削除できず、「ディレクトリが空ではありません」または「バケット内の有効なデータを削除してください」と表示されましたが、どうすればよいですか。

1. 使用しているコンソールのバージョンがV4かV5かを確認し、バージョンV4であれば[チケットを提出](https://console.cloud.tencent.com/workorder/category?level1_id=83&level2_id=84&source=0&data_title=%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%20COS&level3_id=91&radio_title=%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%97%AE%E9%A2%98&queue=28&scene_code=14471&step=2)し、バージョンV5のコンソールへのアップグレードを申請してください。
2. COSの[バージョンV5コンソール](https://console.cloud.tencent.com/cos5)にログインし、削除したいバケットに進み、**アップロード未完了**管理項目をクリックしてファイルフラグメントを削除します。
3. **バケットリスト**に戻り、対応するバケットを削除します。



### バケット内のファイルを誤って削除してしまいましたが、復元は可能ですか。

現時点では、人為的に誤って削除されたファイルの復元はサポートしていません。バケットのバージョン管理機能を有効にしてから、バケットに同名のオブジェクトをアップロードすると、そのオブジェクトの複数のバージョンを保存でき、指定したバージョンのオブジェクトを検索、削除または復元できるようになります。ユーザーが誤って削除したデータや、アプリケーションプログラムの障害によって消失したデータの回復に役立ちます。詳細については、[バージョン管理の設定](https://intl.cloud.tencent.com/document/product/436/19881)をご参照ください。


## ファイルフラグメント

### ファイルフラグメントはどのように発生するのですか。ダウンロードは可能ですか。

ファイルフラグメントはオブジェクトをアップロードする過程で、アップロードを一時停止またはキャンセルした際に発生します。COSは5GBを超える大容量ファイルをマルチパートアップロード方式でアップロードします。その原理は、大容量ファイルを分割し、小さなパートになるよう処理してからアップロードするものです。マルチパートアップロードタスクにおいてAbort Multipart UploadまたはComplete Multipart Uploadインターフェースを呼び出さなかった場合、アップロード済みのパートはファイルフラグメントとして保存されます。ファイルフラグメントのダウンロードはサポートしていません。

### ファイルフラグメントはストレージ容量を占有しますか。料金は発生しますか。

ファイルフラグメントは通常のオブジェクトと同じようにストレージ容量を占有しますので、ストレージ容量料金が発生します。

### ファイルフラグメントを（定期的に）クリーンアップするにはどうすればよいですか。

COSコンソール上でファイルフラグメントを直接削除することができます。操作方法については、[ファイルフラグメントの削除](https://intl.cloud.tencent.com/document/product/436/31632)をご参照ください。[ライフサイクルの設定によるファイルフラグメントの定期的なクリーンアップ](https://intl.cloud.tencent.com/document/product/436/31632#.E9.85.8D.E7.BD.AE.E7.94.9F.E5.91.BD.E5.91.A8.E6.9C.9F.E5.AE.9A.E6.9C.9F.E6.B8.85.E7.90.86.E6.96.87.E4.BB.B6.E7.A2.8E.E7.89.87)によって行うこともできます。

### ファイルフラグメントのクリーンアップは他の完全なアップロードファイルに影響しますか。

ファイルフラグメントのクリーンアップはアップロードに成功しなかったファイルを削除するものであり、すでにアップロードが完了している他のファイルに影響はありません。

## 静的ウェブサイト

### 静的ウェブサイト機能を有効にしているのに、画像を表示することができません。

ブラウザ、CDNキャッシュの有無をチェックしてください。ブラウザキャッシュの防止はcurl、wgetコマンドによって行うことができます。CDNドメイン名を使用してアクセスする場合は、[CDNコンソール](https://console.cloud.tencent.com/cdn)でキャッシュ更新操作を行うことができます。

### 設定した静的ウェブサイトにCDNドメイン名を使用してアクセスできない場合はどうすればよいですか。

次の手順に従ってCDNアクセラレーションドメイン名設定のトラブルシューティングと確認を行ってください。

1. オリジンサーバーのタイプについて、静的ウェブサイトをオリジンサーバーとして選択しているかに注意してください。
2. back-to-origin認証、CDNサービス権限認証はバケットの権限に基づき、それに応じた設定を行う必要があります。
 - バケットの権限がプライベート読み取りの場合は、CDNサービス権限を承認し、back-to-origin認証を有効にする必要があります。
 - バケットの権限がパブリック読み取りの場合は、CDNサービス権限を承認してback-to-origin認証を有効にする必要はありません。
3. CDN認証はバケットの権限に基づき、それに応じた設定を行う必要があります。

a. バケットの権限がプライベート読み取りの場合：

| CDN認証設定 | CDNアクセラレーションドメイン名アクセス | COSドメイン名アクセス    | 一般的なケース         |
| ------------ | ---------------- | --------------- | ----------------------------------- |
| 無効（デフォルト） | アクセス不可           | COSを使用した認証が必要 | CDNドメイン名に直接アクセス可能、オリジンサーバーデータ保護   |
| 有効         | URLを使用した認証が必要  | COSを使用した認証が必要 | 全リンクのアクセスを保護、CDN認証リンク不正アクセス防止をサポート |

b. バケットの権限がパブリック読み取りの場合：

| CDN認証設定 | CDNアクセラレーションドメイン名アクセス | COSドメイン名アクセス | 一般的なケース          |
| ------------ | ---------------- | ------------ | ---------------------------------------- |
| 無効（デフォルト） | アクセス可         | アクセス可      | 全サーバーでパブリックアクセス許可、CDNとオリジンサーバーどちらからのアクセスも可       |
| 有効     | URLを使用した認証が必要  | アクセス可      | CDNアクセスに対してはリンク不正アクセス防止が有効、ただしオリジンサーバーアクセスは保護されないため非推奨 |

4. 上記の設定に誤りがないことを確認した後、CDNアクセラレーションドメイン名へのアクセスに使用するプロトコルおよび静的ウェブサイトの**強制HTTPS**設定を確認してください。

   - CDNアクセラレーションドメイン名へのアクセスにHTTPプロトコルを使用している場合は、**強制HTTPSオプションを有効にしないでください**。
   - CDNアクセラレーションドメイン名へのアクセスにHTTPSプロトコルを使用している場合は、CDNアクセラレーションドメイン名に対し**back-to-originの301/302リダイレクトを有効に**するよう設定することをお勧めします。参考ドキュメント：[back-to-originの301/302リダイレクト設定](https://intl.cloud.tencent.com/document/product/228/7183)。
5. 上記の手順に従ってトラブルシューティングを行っても問題を解決できない場合は、[チケットを提出](https://console.cloud.tencent.com/workorder/category?level1_id=83&level2_id=84&source=0&data_title=%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%20COS&step=1)してご連絡いただければ、さらなるトラブルシューティングを実施することができます。

## クロスドメイン設定

### クロスドメインアクセスとは何ですか。どのように設定しますか。

クロスドメインアクセスとはHTTPリクエストによって、1つのドメインから別のドメインのリソースをリクエストすることであり、プロトコル、ドメイン名、ポートのうちいずれかが異なる場合は、すべて異なるドメインとみなされます。コンソールでの操作手順については、[クロスドメインアクセスの設定](https://intl.cloud.tencent.com/document/product/436/13318)または[クロスドメインアクセス](https://intl.cloud.tencent.com/document/product/436/11488)のベストプラクティスドキュメントをご参照ください。


### バケット内のファイルのheadersが「Access-Control-Allow-Origin:* 」を返すように設定するにはどうすればよいですか。

クロスドメインの設定を行い、Originを`*`に設定します。詳細については、[クロスドメインアクセスの設定](https://intl.cloud.tencent.com/document/product/436/11488)のベストプラクティスドキュメントをご参照ください。

### アップロードの際に「get ETag error, please add "ETag" to CORS ExposeHeader setting. 」というエラーが表示されましたが、どのように対処すればよいですか。

下図に従ってクロスドメインルールを設定し、ブラウザの切り替えを試し、実行可能かどうかのテストを行ってください。詳細については、[クロスドメインアクセスの設定](https://intl.cloud.tencent.com/document/product/436/11488)をご参照ください。
![](https://main.qcloudimg.com/raw/e2cb8ce626ceaba0058423bb5eb72327.png)

### Tencent Cloud COSとCDNを同時に使用すると、COSのクロスドメインが正常に動作しないのですが、どのように対処すればよいですか。

使用しているドメイン名がCDNアクセラレーションドメイン名の場合は、CDNコンソールでクロスドメインの設定を行ってください。詳細については、CDNの[カスタマイズレスポンスヘッダーの設定](https://intl.cloud.tencent.com/document/product/228/35320)のドキュメントをご参照ください。

### クロスドメイン設定はソースOriginのあいまい一致をサポートしていますか。

バージョンV5（XML）のコンソールはセカンドレベルドメイン名のあいまい一致をサポートしています。バージョンV4（JSON）のコンソールはセカンドレベルワイルドカードドメイン名の設定をサポートしていません。

## カスタムHeaders

### オブジェクトヘッダー（Headers）の一括カスタマイズをサポートしていますか。

COSはヘッダーの一括カスタマイズをサポートしています。詳細については、[カスタムHeaders](https://intl.cloud.tencent.com/document/product/436/13361)をご覧ください。

## back-to-origin設定

### back-to-originアドレスの役割は何ですか。

データの移行を行います。COSにユーザーがリクエストしたリソースがない場合は、back-to-originアドレスによってリソースをリアルタイムでプルします。

### back-to-originを設定した時点で、COS上にback-to-originアドレスに対応するリソースまたはパスが存在しない場合、COSはユーザーの初回アクセス後に自動的にディレクトリを作成しますか。

はい。COSは自動的にディレクトリをプルして作成します。

## その他の機能

### COSはコールバックの設定をサポートしていますか。例えば、アップロードした画像ごとにサムネイルを作成し、別のバケットに保存することなどは可能ですか。

COSとSCFを組み合わせて設定することができます。関連する実践ドキュメントは、[COS上の画像を取得してサムネイルを作成](https://intl.cloud.tencent.com/document/product/583/9734)をご参照ください。

### COSは特定のフォルダのサイズの集計をサポートしていますか。

COSは現在のフォルダのオブジェクト数およびオブジェクトが占有する容量サイズの確認をサポートしています。詳細については、[フォルダの詳細確認](https://intl.cloud.tencent.com/document/product/436/31633)をご参照ください。

### COS内のオブジェクトを前のバージョンに戻す設定を行うことは可能ですか。

バケットの[バージョン管理](https://intl.cloud.tencent.com/document/product/436/19883)機能を有効にすると、バケット内にオブジェクトの複数のバージョンを保存でき、なおかつ指定したバージョンのオブジェクトを検索、削除または復元できるようになります。詳細については、[バージョン管理の設定](https://intl.cloud.tencent.com/document/product/436/19881)のドキュメントをご参照ください。

### COS内の特定のタイプのファイルの数（画像ファイルの数など）を確認するにはどうすればよいですか。

リスト機能をアクティブ化し、生成したリストファイルに基づいて確認することができます。詳細については、[リスト機能のアクティブ化](https://intl.cloud.tencent.com/document/product/436/30624)のドキュメントをご参照ください。

