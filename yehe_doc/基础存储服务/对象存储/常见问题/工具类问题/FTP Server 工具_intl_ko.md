### FTP 기능은 어떻게 활성화합니까?

COS는 일종의 Web 방식의 요청을 지원하는 지속성을 지닌 스토리지이며, 네이티브 FTP 액세스 방식을 제공하지 않습니다. FTP 프로토콜을 사용하는 경우 반드시 경유를 거쳐야 하며 **Tencent Cloud 공식 홈페이지에서 제공하는 [FTP Server 툴](https://www.qcloud.com/document/product/436/7214)에 따라 자체적으로 서비스를 구축하여 사용하시기 바랍니다.**
FTP 프로토콜은 오래된 프로토콜로, 데이터 완전성을 검증할 수 없고 전송 보안성을 보장할 수 없으며, CAM 권한 시스템과 연결할 수도 없습니다. 따라서 지속적인 FTP 프로토콜 액세스 사용은 매우 권장하지 않습니다. 또한 Tencent Cloud는 FTP 프로토콜 및 경유 소프트웨어에 대해 향후 지원하지 않을 수 있습니다. 
데이터 동기화가 필요한 경우 [COS Migration 툴](https://intl.cloud.tencent.com/document/product/436/15392) 또는 [COSCMD 툴](https://www.qcloud.com/document/product/436/10976)을 직접 사용하는 것을 권장합니다.

### 구성 파일 중 masquerade_address 선택 항목은 어떤 작용을 합니까? 어떤 경우 masquerade_address를 설정합니까?

masquerade_address는 설정에서 클라이언트에 제공하는 서버 주소입니다. FTP server가 NAT를 통해 공인 IP에 매핑된 호스트에서 실행되는 경우, masquerade_address 옵션을 클라이언트에서 액세스할 수 있는 FTP Server 공인 IP로 설정하고, 서버와 데이터 통신을 완료하는 데 해당 IP가 사용됨을 클라이언트에 공지해야 합니다.

예를 들어 FTP Server가 실행되는 기기에서 ifconfig를 실행하여 외부 네트워크에 매핑된 ENI IP 10.xxx.xxx.xxx를 획득하고, 매핑된 공인 IP가 119.xxx.xxx.xxx라고 가정합니다. 이때 FTP Server에서 클라이언트가 server에 액세스할 때의 공인 IP(119.xxx.xxx.xxx)로 masquerade_address를 명확히 설정하지 않은 경우, FTP Server는 Passive 모드에서 내부 네트워크 주소(10.xxx.xxx.xxx)를 사용하여 클라이언트에 패킷을 반환하게 됩니다. 이때 클라이언트에서 FTP Server 연결은 가능하지만, 클라이언트에 정상적인 데이터 패킷 반환은 불가능합니다.

따라서 일반적으로 masquerade_address를 클라이언트에서 Server 연결 시 사용하는 IP 주소로 설정하는 것을 권장합니다.

### masquerade_address 선택 항목을 정확하게 설정한 후 ftp server에 정상적으로 로그인은 되지만 FTP 명령어인 list 또는 get 등 데이터 검색 명령어 실행 시 '서버에서 라우팅할 수 없는 주소를 반환했습니다.' 또는 'ftp: connect: No route to host' 등의 오류가 발생합니다. 어떻게 처리해야 하나요?

해당 case는 대부분 ftp server 기기 iptables 또는 방화벽 정책 설정이 모든 ICMP 프로토콜 패키지를 reject 또는 drop하여 발생합니다. FTP 클라이언트가 FTP Server 수동 모드에서 반환되는 데이터 연결 IP를 획득하면, 먼저 ICMP 패킷을 발송해 IP의 연결성을 확인합니다. 따라서 클라이언트에서 '서버에서 라우팅할 수 없는 주소를 반환했습니다.'와 같은 오류가 발생하게 됩니다.

권장 솔루션: 필요에 따라 제한할 ICMP 패킷 유형을 reject 또는 drop만 할 수 있도록 iptables 정책을 설정합니다. 외부 ping 유형의 ICMP 패킷만 차단하려는 경우 정책을 `iptables -A INPUT -p icmp --icmp-type 8 -s 0/0 -j [REJECT/DROP]`으로 수정할 수 있습니다.
또는 ftp server에 액세스할 클라이언트의 IP를 단독으로 개방할 수도 있습니다.

### 큰 용량의 파일 업로드 시 중도에 취소했는데 COS에 이미 업로드한 파일이 남아 있는 이유는 무엇입니까?

COS에 사용되는 최신 버전의 FTP Server에서는 완전한 플로우 방식의 업로드 특성을 제공하여 사용자가 파일 업로드를 취소하거나 중단하는 경우 대용량 파일의 업로드 완료 작업을 트리거합니다. 따라서 COS는 사용자 데이터 스트림이 업로드 완료된 것으로 알고 이미 업로드된 데이터를 하나의 완벽한 파일로 구성합니다. 사용자가 다시 업로드하려는 경우 직접 원본 파일 이름으로 업로드하여 덮어쓰거나 수동으로 불완전 파일을 삭제하고 다시 업로드할 수 있습니다.

### 업로드한 파일이 최대 제한을 초과하면 어떻게 됩니까?

실제 업로드한 단일 파일 크기가 구성 파일의 제한을 초과하면 시스템에서 IOError 오류를 반환하며, 로그에 오류 정보를 기록합니다.

기타 문제가 발생하는 경우 [고객센터](https://intl.cloud.tencent.com/contact-sales)를 통해 문의하십시오. 완전한 `cos_v5.log` 로그를 첨부하면 문제를 진단하고 해결하는 데 더욱 도움이 됩니다.

### COS FTP Server 설정에서 파일의 최대 업로드 제한을 두는 이유가 무엇인가요?

COS의 멀티파트 업로드 수는 최대 10000개까지 가능하며, 각 멀티파트의 크기는 1MB~5GB로 제한됩니다. 최대 업로드 제한을 두는 것은 업로드할 멀티파트의 크기를 합리적으로 계산하기 위해서입니다.

FTP Server는 기본적으로 200GB 이내의 단일 파일 업로드를 지원합니다. 그러나 너무 크게 설정하는 것은 권장하지 않습니다. 단일 파일 크기를 크게 설정할수록 업로드 시 멀티파트 버퍼도 늘어나게 되며, 사용자의 메모리 리소스를 소모할 수도 있습니다. 따라서 사용자의 실제 상황에 따라 단일 파일 크기 제한을 합리적으로 설정하시기 바랍니다.



