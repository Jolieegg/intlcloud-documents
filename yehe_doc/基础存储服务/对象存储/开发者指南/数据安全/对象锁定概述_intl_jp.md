## 概要

Tencent CloudのCloud Object Storage（COS）はオブジェクトロック機能を提供しています。ユーザーが設定した保存期間内においてオブジェクトの変更、削除を行えなくする機能です。

>? 
>- オブジェクトロック機能に基づき、COSはSEC Rule 17a-4（f）、FINRA 4511、CFTC 1.31などのコンプライアンス要件を含む、厳格な電子記録保存要件を満たすことが可能となります。
>- SEC 17A-4は米国証券取引委員会が1934年の米国証券取引法に基づいて公布した法規制です。この法規制は、データ保存、インデックス、アクセシビリティの要件について概要を述べたもので、株式、債券、先物などの金融証券取引または仲介業務を行う会社に適用されます。この法規制に基づき、さまざまな種類の取引記録が保存必須かつ上書きおよび消去禁止となり、2年間はすぐにアクセスできる状態、少なくとも6年間はアクセスできる状態であることが求められます。

オブジェクトロック機能は現時点ではバケットレベルの機能であり、各バケットには時間ポリシーに基づいたオブジェクトロックのみを設定することが可能です。保持期間は1日～100年です。保持期間は必ず設定しなければならず、永久の期限は存在しません。

バケットにオブジェクトロックを設定すると、保持期間中は次のようになります。
- オブジェクトは削除、変更できません。
- オブジェクトのストレージタイプは変更できません。
- オブジェクトのHTTPヘッダーおよびユーザーメタデータはどちらも変更できません。これには、Content-Type、Content-Encoding、 Content-Language、Content-Disposition、Cache-Control、Expires、x-cos-meta-が含まれます。
- オブジェクトタグは変更できません。

時間ポリシーに基づいたオブジェクトロックにはステータスが1種類しかなく、時間ポリシーを作成して送信するとすぐに有効になります。このステータスの下ではルールを変更および削除することはできず、保持期間の延長のみが許可されます。


## 利用方法

コンソール、API方式でオブジェクトロックを設定できます。

#### COSコンソールの使用

COSコンソールでオブジェクトロックを設定することができます。[オブジェクトロックの設定](https://intl.cloud.tencent.com/document/product/436/40136) のコンソールガイドドキュメントをご参照ください。

#### REST APIの使用

次のAPIによってオブジェクトロックを直接管理できます。

- [PUT Bucket ObjectLockConfiguration](https://intl.cloud.tencent.com/document/product/436/40133)
- [GET Bucket ObjectLockConfiguration](https://intl.cloud.tencent.com/document/product/436/40134)
- [GET Object Retention](https://www.tencentcloud.com/document/product/436/40135) 


## 制限事項

1. オブジェクトロック機能は現在ホワイトリストのお客様にのみ開放されています。詳しくは[お問い合わせ](https://intl.cloud.tencent.com/contact-sales)ください。
2. バケットのオブジェクトロックを有効化すると、およそ5秒以内に発効します。
3. オブジェクトロック機能は既存バケットの既存オブジェクトをサポートしています。次の例をご参照ください。
例えばお客様が、2012年7月1日にexamplebucketという名前のバケットを作成し、かつ異なる時点でtest1.txt、 test2.txt、test3.txtという3ファイルをアップロードし、その後2013年9月1日に保持期間を5年とするオブジェクトロックポリシーを作成したとします。これらの3ファイルの具体的なアップロード時間および対応するオブジェクトロックルールの有効期限は次のとおりです。
<table>
	<tr><th>ファイル名</th><th>アップロード時間</th><th>オブジェクトロックルールの有効期限</th></tr>
	<tr><td>test1.txt</td><td>2012年7月1日</td><td>2017年6月30日</td></tr>
	<tr><td>test2.txt</td><td>2013年9月1日</td><td>2018年8月31日</td></tr>
	<tr><td>test3.txt</td><td>2017年7月30日</td><td>2022年7月29日</td></tr>
</table>

4. オブジェクトロックはバージョン管理機能をサポートしていません。オブジェクトロックを有効にしたバケットではバージョン管理を有効にすることはできず、バケットのバージョン管理が有効、一時停止状態のどちらであってもオブジェクトロックを有効にすることはできません。
5. オブジェクトロックはバケットコピー機能をサポートしていません。オブジェクトロックはバージョン管理機能との互換性が無く、かつバケットコピールールの下では、ソースバケットとターゲットバケットがバージョン管理を有効にすることが必須なため、オブジェクトロックを有効にしたバケットはバケットコピーのソースバケット、ターゲットバケットにすることができません。
6. オブジェクトロックはINTELLIGENT_TIERING機能をサポートしていません。オブジェクトロックを有効にしたバケットではINTELLIGENT_TIERING設定を有効にすることはできず、バケットでINTELLIGENT_TIERING設定を有効にすると、オブジェクトロックを有効にすることはできなくなります。
7. 保持期間内では、ロックされたオブジェクトはストレージタイプを切り替えることができません。また、オブジェクトロックとライフサイクルルールには互換性がありません。オブジェクトロックを有効にしたバケットではライフサイクルルールの設定がサポートされず、バケットにライフサイクルルールが含まれている場合は、オブジェクトロックを有効にすることはできません。
8. バケットでオブジェクトロックを有効化すると、ファイルフラグメントはオブジェクトロックルールによる制限を受けなくなるため、ユーザーはバケット内のファイルフラグメントをクリーンアップすることができます。
9. オブジェクトロック機能は有効化後に無効化することはできません。バケット内の全ファイルをクリアしてから、バケット自体を削除することによってオブジェクトロックルールをキャンセルすることができます。
10. オブジェクトロックを有効にすると、バケットおよびオブジェクトACLを変更することができます。
