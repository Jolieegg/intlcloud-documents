コンソールでバッチ処理タスクの管理を行うことができます。ここではバッチ処理タスクに関する管理操作について詳細にご説明します。

## タスクのフィルタリング

[List Jobs](https://intl.cloud.tencent.com/document/product/436/33783)APIによって、過去90日間に作成されたバッチ処理タスクをリストアップすることができます。バッチ処理タスクリストには、例えばタスクID、タスクの説明、タスクの優先度、タスクのステータス、タスクの実行状況などの、各バッチ処理タスクの情報が含まれます。タスクのステータスによって、バッチ処理タスクリストから同一のステータスにあるタスクをフィルタリングすることができます。コンソール上でフィルタリング操作を行う場合は、タスクの説明またはタスクIDによってもフィルタリングが可能です。

## タスクのステータスの照会

例えば、タスクに関するより多くの情報を取得したい場合は、[DescribeJob](https://intl.cloud.tencent.com/document/product/436/33782)APIによって単一のタスクのすべての情報を取得することができます。このインターフェースは指定されたタスクの操作設定、オブジェクトリストの情報、タスクレポートなどの情報を返します。このインターフェースによって指定のタスクの詳細を把握することができます。

## タスクの優先度の割り当て

ご自身のタスクに対し、それに応じた優先度を設定することができます。COSはお客様の設定した優先度に応じてバッチ処理タスクを処理します。高優先度のタスクは優先的に実行されます。優先度は整数型の数値で表し、順位は降順、すなわち数値が大きいほど優先度が高いことを表します。優先度はタスクの実行中に変更することができます。タスクの実行中に優先度がより高いタスクが新たに追加された場合は、優先度の低いタスクを一時停止し、高優先度のタスクを実行することができます。

> !高優先度のバッチ処理タスクは通常、低優先度のタスクより優先的に実行されますが、優先度はシーケンシャルな実行における唯一の基準とはなりません。複数のバッチ処理タスクを順に実行するよう設定する必要がある場合は、それが実現されるよう、各タスクの実行状態をご自身で監視してください。

## タスクのステータス

あるタスクを作成した後、タスクのステータスは次のいくつかのステータスの間で切り替わります。ステータス切り替えの図は次のとおりです。
![](https://qcloudimg.tencent-cloud.cn/raw/f1b6e51eadf4930922a1f929351903bb.png)


タスクの各ステータスの意味について、次の表で詳しくご説明します。

| タスクのステータス   | 説明                                                         | 次のステータス                                                     |
| ---------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| New        | 1つのタスクが作成されたばかりのとき、タスクのステータスはNewとなります。                    | Preparingに切り替え可能です。これはCOSがタスク内のリストの解析を開始したことを表します。        |
| Preparing  | COSがバッチ処理タスク内に設定されたリストおよびその他の情報の解析を開始した時点で、タスクのステータスはPreparingとなります。 | ReadyまたはSuspendedステータスに切り替え可能です。Readyステータスへの切り替えは、バッチ処理タスクの設定情報のCOSによる解析がすでに完了し、COSはその設定に基づいてリスト内のオブジェクトに対し指定された操作を実行できる状態であることを表します。Suspendedステータスへの切り替えは、バッチ処理タスクの設定情報のCOSによる解析はすでに完了しているものの、COSが実行前にお客様による確認を必要としていることを表します。このステータスはコンソールでバッチ処理タスクの設定を行った場合に表示されます。 |
| Suspended  | バッチ処理タスクがお客様による確認を待ってから実行する必要がある場合、この確認待ちの状態をSuspendedと呼びます。このステータスはコンソール上でタスクを作成した場合に生成されます。お客様の確認を経て、COSがタスクの実行を開始した場合、このステータスは次のステータスに切り替わり、再びこのステータスに戻ることはありません。 | お客様がタスクの実行を確認した時点で、タスクのステータスはReadyに切り替わります。                 |
| Ready      | COSがバッチ処理タスク内のオブジェクトリストおよびタスク設定情報の解析を完了し、バッチ処理タスクをすぐに実行できる状態になった時点で、タスクのステータスはReadyとなります。 | Activeステータスに切り替え可能です。その時点でCOSはタスクの実行を開始します。実行中の高優先度のタスクがある場合は、COSは高優先度のタスクのステータスがCompleteに切り替わるまで、タスクのステータスをReadyのままにします。 |
| Active     | COSがバッチ処理タスク内の設定情報に基づいてリスト内のオブジェクトに対する操作を実行中のとき、タスクのステータスはActiveとなります。コンソール上で、または[DescribeJob](https://intl.cloud.tencent.com/document/product/436/33782)APIの呼び出しなどの方法でタスクの進捗状況を照会できます。 | Complete、Failing、PausingまたはCancellingなどのステータスに切り替え可能です。タスクが正常に終了または失敗した場合、または中止コマンドによって、例えばタスクのキャンセルなどがあった場合、ステータスは具体的な原因に応じて切り替わります。 |
| Pausing    | COSが処理中のバッチ処理タスクを中断した場合は、Pausedの中間ステータスであるPausingに切り替わります。 | Pausedステータスに切り替え可能です。実行中だったバッチ処理タスクが中止されたことがCOSによって確認された場合、ステータスはPausedに切り替わります。 |
| Paused     | 高優先度のバッチ処理タスクを作成すると、その時点で実行中だったバッチ処理タスクはPausedステータスに切り替わります。 | 高優先度のタスクが完了、失敗または確認待ちとなった時点で、Pausedステータスのタスクは自動的にActiveステータスに切り替わります。 |
| Complete   | バッチ処理タスクのリスト内の全オブジェクトに対するバッチ操作が正常に完了または失敗した場合、タスクのステータスはCompleteに切り替わります。<br>タスクレポートを生成するよう設定している場合は、COSがタスクのステータスをCompleteに切り替えた時点で、タスクレポートが指定されたバケットに送信されます。 | Completeステータスは最終のステータスであり、あるタスクがCompleteステータスに切り替わった場合、それからさらに他のステータスに切り替わることはありません。 |
| Cancelling | COSが処理中のバッチ処理タスクをキャンセルした場合は、Cancelledの中間ステータスであるCancellingに切り替わります。 | Cancelledステータスに切り替え可能です。実行中だったバッチ処理タスクがキャンセルされたことがCOSによって確認された場合、ステータスはCancelledに切り替わります。 |
| Cancelled  | バッチ処理タスクが正常にキャンセルされた場合、タスクのステータスはCancelledとなり、その時点でタスクのステータスにはいかなる変更もできなくなります。 | Cancelledステータスは最終のステータスであり、あるタスクがCancelledステータスに切り替わった場合、それからさらに他のステータスに切り替わることはありません。 |
| Failing    | COSがFailedに切り替える中間ステータスがFailedです 。                  | Failedステータスに切り替え可能です。                                        |
| Failed     | タスクが失敗すると、タスクのステータスはFailedとなります。タスク失敗の詳細情報に関しては、[失敗したタスクの追跡](https://intl.cloud.tencent.com/document/product/436/32961#tracking-a-failing-job)をご参照ください。 | Failedステータスは最終のステータスであり、あるタスクがFailedステータスに切り替わった場合、それからさらに他のステータスに切り替わることはありません。 |



## 失敗したタスクの追跡

バッチ処理タスクの実行中に、例えばオブジェクトリストの解析が正常に行えないなどの問題が発生した場合は、バッチ処理タスクの実行は失敗となり、COSは対応するエラーコードおよびエラーの原因を返します。COSはタスク失敗の原因を保存し、お客様は[DescribeJob](https://intl.cloud.tencent.com/document/product/436/33782)APIによってタスク失敗の詳細情報を取得することができます。タスクレポートによってタスク失敗の原因およびその他の関連情報を取得することもできます。

COSは各バッチ処理タスクにつき操作失敗閾値を設けることで、作成したタスクに大量の失敗操作が発生することを防止します。1つのタスクに1000以上の操作が存在する場合、COSは操作の失敗率を監視します。任意の時刻における操作失敗率（現在の実行における失敗操作を実行済みの全操作数で割ったもの）が50%の閾値を超えた場合、COSはタスクを終了し、失敗のステータスを返します。操作失敗率が閾値を超過した原因をお客様ご自身で調べることも可能です。例えばオブジェクトリストに大量の存在しないオブジェクト情報が含まれていた場合などは、エラーを修復した後に再度タスクを作成することができます。

> !COSのバッチ処理タスクは非同期方式によって実行され、かつオブジェクトに対する操作は必ずしもリストに列記されたオブジェクトの順序に従って行われるわけではありません。このため、オブジェクトリスト内のオブジェクトの順序によって、タスクがどのオブジェクトまで操作を行ったかを判断し、それによって操作の成功または失敗を判断することはできません。ただし、タスクレポートから操作の成功または失敗の情報を取得することはできます。


## タスクレポート

タスクを作成する際に、タスクレポートを出力するかどうかを設定できます。タスクレポートを出力するよう設定した場合、COSはタスクの成功、失敗またはタスクがキャンセルされた際にレポートを出力し、お客様はそのレポート上で、タスクが関与したすべての成功または失敗操作の状況を確認することができます。

タスクレポートにはタスクの指定された操作の設定パラメータ、実行ステータスなどの情報が含まれるほか、処理対象のオブジェクト名、バージョンID、操作ステータスコードおよびエラーの説明などの内容も含まれます。
