## 基本概念

静的ウェブサイトとは静的コンテンツ（HTMLなど）またはクライアントサイドスクリプトを含むウェブサイトを指します。ユーザーはコンソール上で、カスタムドメイン名をバインド済みのバケットに対して静的ウェブサイト設定を行うことができます。一方、動的ウェブサイトのコンテンツにはPHP、JSP、ASP.NETなどのサーバーサイドスクリプトが含まれ、サーバー側に依存して処理する必要があります。Cloud Object Storage（COS）は静的ウェブサイトのホスティングをサポートしていますが、サーバーサイドスクリプトの作成はサポートしていません。動的ウェブサイトをデプロイしたい場合は、Cloud Virtual Machine（CVM）を使用してサーバー側のコードデプロイを行うことをお勧めします。

## 事例

ユーザーがexamplebucket-1250000000という名前のバケットを作成し、次のファイルをアップロードしたとします。 

```shell
index.html
404.html
403.html
test.html
docs/a.html
images/
```

### 静的ウェブサイト

**有効化前**：次のようなデフォルトアクセスドメイン名を使用してバケットにアクセスすると、ダウンロードの表示がポップアップされ、`index.html`ファイルをローカルに保存することができます。

```shell
https://examplebucket-1250000000.cos-website.ap-guangzhou.myqcloud.com/index.html
```

**有効化後**：次のようなアクセスノードを使用してバケットにアクセスすると、ブラウザで直接`index.html`のページ内容を確認することができます。

```shell
https://examplebucket-1250000000.cos-website.ap-guangzhou.myqcloud.com/index.html
```

### 強制HTTPS

**有効化前**：リクエストのソースがHTTPの場合、アクセスノードのURLはHTTPの暗号化されていない転送プロトコルを維持します。

```shell
http://examplebucket-1250000000.cos-website.ap-guangzhou.myqcloud.com
```

**有効化後**：リクエストのソースがHTTPとHTTPSのどちらであっても、アクセスノードは常にHTTPSの暗号化された転送プロトコルを維持します。

```shell
https://examplebucket-1250000000.cos-website.ap-guangzhou.myqcloud.com
```

### インデックスドキュメント

インデックスドキュメント（静的ウェブサイトのホームページ）は、ユーザーがウェブサイトのルートディレクトリまたは任意のサブディレクトリにリクエストを送信したときに返されるページで、通常このページは`index.html`と命名されます。
ユーザーがバケットのアクセスドメイン名（例：`https://examplebucketbucket-1250000000.cos-website.ap-guangzhou.myqcloud.com`）を使用して静的ウェブサイトにアクセスし、なおかつ特定のページをリクエストしていない場合、Webサーバーからはトップページが返されます。

お客様のユーザーがアクセスするバケットに、ルートディレクトリを含む何らかのディレクトリが含まれる場合、URLアドレスが`/`で終わるものは、このディレクトリ下のインデックスドキュメントに優先的に自動マッチングされます。ルートレベルのURLの`/`はオプションです。次の任意のURLはインデックスドキュメントを返します。

```shell
http://www.examplebucket.com/
http://www.examplebucket.com
```

> !バケット内にフォルダを作成した場合、各フォルダレベルでインデックスドキュメントを追加する必要があります。

### エラードキュメント

エラードキュメントを設定する前に次のページにアクセスした場合、ステータスコード404が返され、ページ上にデフォルトのエラーページメッセージが表示されます。

```shell
https://examplebucket-1250000000.cos-website.ap-guangzhou.myqcloud.com/webpage.html
```

エラードキュメントを設定すると、次のページにアクセスした場合、同じようにステータスコード404が返されますが、ページ上には指定したエラーページメッセージが表示されます。

```shell
https://examplebucket-1250000000.cos-website.ap-guangzhou.myqcloud.com/webpage.html
```

### リダイレクトルール

>?静的ウェブサイトのホスティングにリダイレクトルールを設定する場合、ドキュメントのパスの代わりにバケット内のオブジェクトパスが必要です。

#### エラーコードのリダイレクト設定

例えばwebpage.htmlというドキュメントに**プライベート読み取り/書き込み**のパブリックアクセス権限を設定した場合、ユーザーがこのファイルにアクセスすると、403エラーが返されます。
エラーコード403を403.htmlにリダイレクトすると、ブラウザは403.htmlの内容を返します。
403.htmlドキュメントを設定していない場合、ブラウザはエラードキュメントまたはデフォルトのエラーメッセージを返します。
![](https://main.qcloudimg.com/raw/f728aec922e088f45889349f31bcdc08.png)

#### プレフィックスマッチングの設定

>!プレフィックスマッチングはワイルドカードをサポートしていません。プレフィックスを index1/、index2/ という2つのフォルダとしてリダイレクトしたい場合、 `index*/` をマッチングルールとして使用することはできず、対応するマッチングルールをそれぞれ作成する必要があります。

1. フォルダを`docs/`から`documents/`にリネームした場合、ユーザーが`docs/`フォルダにアクセスするとエラーが発生します。そのため、プレフィックスが`docs/`のリクエストを`documents/`にリダイレクトすることができます。
![](https://main.qcloudimg.com/raw/9e8bbe91d902b46146c207a61e092e1d.png)
2. `images/`フォルダを削除（プレフィックス`images/`を持つすべてのオブジェクトを削除）した場合、リダイレクトルールを追加し、プレフィックスが`images/`のあらゆるオブジェクトのリクエストを、`test.html`ページにリダイレクトすることができます。
![](https://main.qcloudimg.com/raw/ceb0d796e1330c1b203578a1472532e6.png)

