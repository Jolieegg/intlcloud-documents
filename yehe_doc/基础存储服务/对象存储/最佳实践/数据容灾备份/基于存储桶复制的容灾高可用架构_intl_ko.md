## 소개

Tencent Cloud COS는 99.95%의 가용성과 99.999999999%의 신뢰성을 자부합니다. 하지만 자연재해, 광케이블 장애와 같은 불가항력적 요인들로 인해 클라우드 데이터의 가용성과 신뢰성이 100%에 도달할 수는 없습니다. 반면 금융업과 같은 일부 업종은 그 특수성으로 인해 상당히 높은 수준의 가용성과 신뢰성이 요구됩니다.

Tencent Cloud COS는 기업 비즈니스의 연속성과 안정성을 도모하여 기업의 고가용성 및 고신뢰성에 대한 요구사항을 충족하기 위해 버킷 복사 기능을 기반으로 한 고가용성의 데이터 재해 복구 솔루션을 제공합니다. 기업은 클라우드 이용 시 비즈니스 요구사항에 맞춰 클라우드 내 데이터를 재해 복구하고 백업함으로써 비즈니스를 지속적이며 안정적으로 운영할 수 있습니다.

본 문서에서는 버킷 복사를 기반으로 한 클라우드 비즈니스의 액티브/스탠바이 전환이라는 재해 복구 솔루션과, 버킷 복사를 기반으로 한 고가용성 솔루션의 두 가지 내용을 주로 소개합니다. 버킷 복사, Origin-pull, SCF, CDN 등 다양한 제품과 기능을 통해 비즈니스 가용성을 향상시킬 수 있습니다.

## 버킷 복사 기반의 재해 복구 백업 솔루션

재해 복구를 위해서는 이중화(Redundance), 원거리(Remote), 데이터 전체 백업(Replication)라는 세 가지 요소가 충족돼야 합니다.

- 이중화: 데이터 이중화를 뜻하며, 데이터를 사용 가능한 다른 시스템으로 백업해야 합니다.
- 원거리: 백업 데이터를 원거리의 다른 리전에 보관해야 합니다. 재해는 보통 인근 지역으로 여파가 미치기 때문에, 충분한 거리를 확보해야만 이중화 데이터의 가용성을 보장할 수 있습니다.
- 데이터 전체 백업: 백업 데이터의 유실률을 '제로(zero)'로 확보해야 합니다.

COS의 버킷 복사 기능은 증분 데이터의 리전 간 동기화를 지원합니다. 사용자가 업로드한 데이터는 파일 크기와 리전 거리에 따라 다른 리전의 버킷으로 복제되기까지 수 초에서 수 분의 시간이 소요될 수 있습니다. 버킷 복사를 기반으로 할 경우, 데이터를 타 리전에 이중으로 백업함으로써 비즈니스를 위한 재해 복구 조치를 취할 수 있습니다. 버킷 복사에 관한 내용은 [버킷 복사 개요](https://intl.cloud.tencent.com/document/product/436/19237)를 참조하십시오. 버킷 복사 기능을 활성화하려면 우선 버전 제어 기능을 활성화해야 합니다. 버전 제어와 관련한 내용은 [버전 제어 개요](https://intl.cloud.tencent.com/document/product/436/19883)를 참조하십시오.

버킷 복사 기반의 재해 복구 백업 아키텍처의 순서도는 다음과 같습니다.
![](https://main.qcloudimg.com/raw/fba213608e66f1e8b8426692eb709f33.png)

이 아키텍처에서 사용자의 버킷 A와 버킷 B는 액티브/스탠바이 관계입니다. 예를 들어 기업 사용자의 데이터가 버킷 A에 보관되어 있는 경우, 다른 리전의 버킷 B는 스탠바이용 버킷입니다. 이 기업이 비즈니스의 연속성과 안정성을 보장하기 위해 버킷 A와 B에 각각 버킷 복사 규칙을 설정 및 적용했다면, 버킷 A의 증분 데이터는 버킷 B에 자동 복제되며 버킷 B의 증분 데이터도 버킷 A로 자동 복제됩니다.

> !버킷 A에서 버킷 B로 복제된 증분 데이터는 비록 버킷 B의 증분 데이터일지라도 버킷 A로 재차 복제되지 않습니다.

특별한 문제가 없는 경우, 기업의 주요 읽기/쓰기 요청 링크는 버킷 A를 지향하며, 모든 증분 데이터는 백업 데이터로서 버킷 B로 자동 증분 되어 동기화 복제됩니다. 사용자는 프로그램을 업로드하거나 다운로드할 때 네트워크 품질 점검 모듈을 추가할 수 있으며, 액티브 버킷 A가 다운됐음을 감지하면 읽기/쓰기 요청 링크를 신속히 스탠바이 버킷 B로 전환합니다.

> !Tencent Cloud의 SCF를 기반으로 네트워크 품질을 점검할 수 있습니다. SCF 코드를 수정하여 자동화 테스팅 주소를 액티브/스탠바이 버킷의 도메인으로 변경할 수 있으며, 비즈니스 요구사항에 맞춰 알람 코드 스니펫을 다른 비즈니스에 필요한 상태로 변경할 수 있습니다.

## 버킷 복사 기반의 고가용성 솔루션

앞서 버킷 복사 기반의 재해 복구 백업 솔루션을 소개했습니다. 이 솔루션은 클라우드의 제품과 기능을 활용한 데이터 백업 및 재해 복구를 위한 전환 작업을 지원합니다. 하지만 실제 비즈니스는 복잡하고 다양하게 운영되기 때문에 상술한 재해 복구 백업 솔루션이 비즈니스적으로 충분한 가용성을 보장하지 못할 수 있습니다. 따라서 다음과 같은 버킷 복사 기반의 고가용성 솔루션을 소개합니다. 버킷 복사, Origin-pull, SCF, CDN 등 다양한 제품과 기능을 활용해 비즈니스 가용성을 높일 수 있습니다.

버킷 복사 기반의 비즈니스 고가용성 아키텍처의 순서도는 다음과 같습니다.
![](https://main.qcloudimg.com/raw/e56c3707f14b2e30c216e22c4c68eda0.png)

본 아키텍처는 다음과 같은 몇 개의 레이어로 나뉩니다.

- **고가용성 레이어**: 통합 네트워크 점검 및 비즈니스 스케쥴링 시 링크의 상호접속률 등 지표에 따라 링크를 전환하며, 사용자가 SCF를 토대로 실현(설명 참조)할 수 있습니다. 또한 비즈니스 요구사항에 맞춰 클라이언트에서 직접 실현하는 것도 가능합니다.
- **스토리지 레이어**: 보통 COS의 다른 리전의 버킷으로 구성됩니다. 사용자는 [Origin-pull 정책 설정](https://intl.cloud.tencent.com/document/product/436/31508)을 통해 **외부 원본 서버나 타 클라우드 벤더에 있는** 버킷을 가져와 데이터 일관성을 보다 강화할 수 있습니다.
- **CDN 레이어**: Tencent Cloud CDN의 대용량 엣지 노드는 근거리 액세스 기능을 지원합니다. 사용자가 직접 원본 서버 데이터에 액세스하는 것을 방지함으로써 원본 서버 데이터의 보안성을 보장합니다.

본 아키텍처는 다음과 같은 방법으로 비즈니스의 고가용성을 보장합니다.

1. 특별한 문제가 없는 경우, 기업의 주요 쓰기 요청 링크는 버킷 A를 지향하며, 모든 증분 데이터는 백업 데이터로서 버킷 B로 자동 동기화 복제됩니다.
2. 액티브 버킷 A의 링크에 장애(예: 자동화 테스팅 품질 저하 또는 업로드 실패 감지)가 발생하면 클라이언트에서 쓰기 요청 링크를 액티브 버킷 B로 전환합니다. 이때 모든 증분 데이터는 버킷 A로 자동으로 동기화되어 복제됩니다.
3. 사용자는 외부 원본 서버나 타 클라우드 벤더 측에 이중화 데이터를 백업하는 것과 함께 버킷 B에 Origin-pull 정책을 설정할 수 있습니다. 만약 액티브 버킷 A와 B의 링크가 동시에 연결되지 않는 최악의 상황을 가정할 경우, 버킷 B에 대한 데이터 업로드가 실패하면 버킷 B가 원본 서버로부터 데이터를 가져오게 됩니다.

> !
>
> - 데이터 전체를 이중화하여 백업할 경우 많은 비용이 부과됩니다. 핫 데이터(예: 몇 시간 내 업로드한 파일)에 한해 이중화 백업을 함으로써 데이터 스토리지 비용을 절약할 수 있습니다.
> - 원본 서버를 고가용성 아키텍처의 일부로 선택할 경우, 원본 서버의 대역폭과 대역폭 제한에 따른 결과를 고려하여 아키텍처를 설계하십시오.

4. 버킷에 직접 액세스하여 데이터를 읽어올 수 있으며, 버킷에 [CDN 가속 도메인 바인딩](https://intl.cloud.tencent.com/document/product/436/18670)을 하여 Tencent Cloud CDN의 엣지 노드에서 근거리 액세스를 할 수 있습니다. 비즈니스 데이터가 콘텐츠 전송 시나리오와 관련이 있거나 사용자가 버킷에 직접 액세스하는 것을 원치 않을 경우, [Tencent Cloud CDN](https://intl.cloud.tencent.com/document/product/228)을 함께 사용하는 것을 권장합니다.

> ?
>
> - 버킷에서 직접 데이터를 읽어오려면 클라이언트에서 follow HTTP 302를 지원해야 합니다.
> - Tencent Cloud CDN은 약 천 개의 엣지 노드를 제공합니다. 사용자와 가까운 거리에 액세스 노드를 제공하여 읽어오는 속도를 높이고 있습니다. CDN에 여러 개의 원본 서버를 액티브/스탠바이 관계로 바인딩함으로써 고가용성을 보장할 수 있습니다. [원본 서버 설정](https://intl.cloud.tencent.com/document/product/228/6289)을 참고하여 설정하십시오.
> - 원본 서버의 보안을 강화하려면 원본 서버의 개인 읽기/쓰기 및 CDN Origin-pull 인증을 활성화하십시오. 사용자는 CDN 엣지 노드에 캐싱된 데이터에 익명으로 액세스할 수 있을 뿐만 아니라 원본 서버의 데이터 보안도 확보할 수 있습니다.

## 참조 문서

재해 복구를 위한 고가용성 아키텍처를 사용할 때 다음 문서를 참조할 수 있습니다.

- [버전 제어 개요](https://intl.cloud.tencent.com/document/product/436/19883)
- [버킷 복사 개요](https://intl.cloud.tencent.com/document/product/436/19237)
- [Origin-pull 설정](https://intl.cloud.tencent.com/document/product/436/31508)
- [CDN 가속 설정](https://intl.cloud.tencent.com/document/product/436/18670)
- [원본 서버 설정](https://intl.cloud.tencent.com/document/product/228/6289)
- [도메인 액세스](https://intl.cloud.tencent.com/document/product/228/5734)
