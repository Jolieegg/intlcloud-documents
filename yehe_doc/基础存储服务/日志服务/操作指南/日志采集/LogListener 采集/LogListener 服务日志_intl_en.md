## Overview
LogListener service logs are used to record the operation, collection, and monitoring activities of LogListener, and you can configure visualized graphs to display such log data.

### Default configuration

| Default Configuration Item | Description |
| ------------ | ------------------------------------------------------------ |
| Log Topic | When you enable LogListener service logs, the logset `cls_service_logging` will be created for you automatically, and all log data generated by associated machine groups will be categorized and stored in corresponding log topics. The following three log topics are created by default: <li>`loglistener_status`: the heartbeat status logs for the corresponding LogListener. </li><li>`loglistener_alarm`: logs corresponding to LogListener's monitoring by collection metric/error type . </li><li>`loglistener_business`: logs corresponding to LogListener's collection operations, with each log corresponds to one request. </li> |
| Region        | After the LogListener log services are enabled, logsets and log topics will be created under the machine groups in the same region of LogListener.|
| Log Storage Duration | The default storage duration is 7 days, and the value cannot be modified.                            |
| Index | Full-text index and key-value index are enabled for all collected log data by default. You can modify the index configuration. For details, please see [Configuring Index](https://intl.cloud.tencent.com/document/product/614/39594). |
| Dashboard | Dashboard `service_log_dashboard` will be created in the same region of LogListener by default. |

>?
> - LogListener service logs are only about collection and monitoring activities of LogListener, and do not support writing into other kinds of data.
> - Log data generated by this feature does not incur costs.
> - `cls_service_logging` is a unified logset for LogListener service logs.

## Operations

- **Viewing LogListener status**
When the LogListener service logs are enabled, you can view LogListener running status and collection statistics. You can view the number of active LogListeners, LogListener status distribution and other statistical metrics on the `service_log_dashboard` dashboard.

- **Log collection monitoring configuration**
You can configure the collection and monitoring service logs by metric/error type. For example:
  - MEM, CPU, collection speed, collection latency, or other metrics
  - The number of parsing errors of LogListener

- **File-level monitoring**
With the LogListener service logs are enabled, you can view the monitoring logs of files and directories. For example:
  - All collection statistics files of one IP
  - The amount of logs collected under a certain path on a certain IP, such as `app1` application logs located in `/var/log/app1/`. You can get the statistics of logs collected under this path.
  - The collection statistics of a topic.


## Prerequisites

Only LogListener v2.5.4 and above support collection and monitoring service logs by machine/machine group. You’re advised to upgrade LogListener to the [latest version](https://intl.cloud.tencent.com/document/product/614/17414).

## Directions
### Enabling service logs

1. Log in to the [CLS console](https://console.cloud.tencent.com/cls).
2. In the left sidebar, click **Machine Group** to go to the machine group management page.
3. On the machine group list page, select the target machine group and click ![](https://main.qcloudimg.com/raw/f49ecfc95ee483de28fb0928a4ada2dd.png) to enable the LogListener service logs.


### Disabling service logs

1. Log in to the [CLS console](https://console.cloud.tencent.com/cls).
2. In the left sidebar, click **Machine Group** to view the machine group list.
3. Select the target machine group, and click ![](https://main.qcloudimg.com/raw/b9a30517065edbe87527257fcc100184.png) to disable the LogListener service logs.

>? After this feature is disabled, the log data saved in the logset `cls_service_logging` will not be deleted automatically. You can manually delete the logset where the service logs are saved.
>

## Dashboard of Service Logs

When the LogListener service logs are enabled, CLS will create a dashboard `service_log_dashboard` by the type of recorded logs to display LogListener’s collection and monitoring statistics.

#### Collection statistics dashboard
You can go to the [Dashboard](https://console.cloud.tencent.com/cls/dashboard) page of the CLS console, and click the ID of the target dashboard to view LogListener collection statistics, including the LogListener status, parsing failure rate, sending success rate, and other metrics.


## Log Types

### LogListener status logs
The parameters of the log topic `loglistener_status` are detailed as follows:
<table>
	<tr><th>Parameter</th><th>Description</th></tr>
	<tr><td>InstanceId</td><td>LogListener unique identifier</td></tr>
	<tr><td>IP</td><td>Machine group IP</td></tr>
	<tr><td>Label</td><td>An array of machine IDs</td></tr>
	<tr><td>Version</td><td>Version number</td></tr>
	<tr><td>MemoryUsed</td><td>Memory utilization of LogListener</td></tr>
	<tr><td>MemMax</td><td>Memory utilization threshold on this machine set by the Agent</td></tr>
	<tr><td>CpuUsage</td><td>LogListener CPU utilization</td></tr>
	<tr><td>Status</td><td>LogListener running status</td></tr>
	<tr><td>TotalSendLogSize</td><td>Size of logs sent</td></tr>
	<tr><td>SendSuccessLogSize</td><td>Size of successfully sent logs</td></tr>
	<tr><td>SendFailureLogSize</td><td>Size of sending-failed logs</td></tr>
	<tr><td>SendTimeoutLogSize</td><td>Size of logs with sending timed out</td></tr>
	<tr><td>TotalParseLogCount</td><td>Total number of logs parsed</td></tr>
	<tr><td>ParseFailureLogCount</td><td>Number of parsing-failed logs</td></tr>
	<tr><td>TotalSendLogCount</td><td>Number of logs sent</td></tr>
	<tr><td>SendSuccessLogCount</td><td>Number of successful sent logs</td></tr>
	<tr><td>SendFailureLogCount</td><td>Number of sending-failed logs</td></tr>
	<tr><td>SendTimeoutLogCount</td><td>Number of logs with sending timed out</td></tr>
	<tr><td>TotalSendReqs</td><td>Total number of requests sent</td></tr>
	<tr><td>SendSuccessReqs</td><td>Number of successful sent requests</td></tr>
	<tr><td>SendFailureReqs</td><td>The number of sending-failed requests</td></tr>
	<tr><td>SendTimeoutReqs</td><td>Number of requests with sending timed out</td></tr>
	<tr><td>TotalFinishRsps</td><td>Total number of RSP files received</td></tr>
	<tr><td>TotalSuccessFromStart</td><td>Total number of successfully sent requests since LogListener was enabled</td></tr>
	<tr><td>AvgReqSize</td><td>Average request packet size</td></tr>
	<tr><td>SendAvgCost</td><td>Average sending time</td></tr>
	<tr><td>AvailConnNum</td><td>Number of available connections</td></tr>
	<tr><td>QueueSize</td><td>The size of queued requests</td></tr>
</table>





### LogListener alarm logs
The parameters of the log topic `loglistener_alarm` are detailed as follows:

| Monitoring Metric | Description |
| :----------- | :-------------------- |
| InstanceId | LogListener unique identifier |
| Label | An array of machine IDs |
| IP | Machine group IP |
| Version | LogListener version |
| AlarmType.count | Statistics of alarm types |
| AlarmType.example | Sample alarm type |


**AlarmType:**

| alarm type | type ID | Description |
| :------------------------ | :------ | :---------------------------------------- |
| UnknownError | 0 | Initializing the alarm type. |
| UnknownError | 1 | Failed to parse. |
| CredInvalid | 2 | Failed to verify. |
| SendFailure | 3 | Failed to send. |
| RunException | 4 | Abnormal LogListener running. | 
| MemLimited | 5 | Reached the memory utilization threshold. |
| FileProcException | 6 | Exceptions occurred in file processing. |
| FilePosGetError | 7 | Failed to get the file publishing info. |
| HostIpException | 8 |  Exceptions occurred in the server IP thread. |
| StatException| 9 | Failed to get the process info.|
| UpdateException | 10 | Exceptions occurred in the CLS modification feature. |
| DoSendError | 11 | Failed to confirm sending.   |
| FileAddError | 12 | Failed to create the file.  |
| FileMetaError | 13 | Failed to create the metadata file.  |
| FileOpenError | 14 | Failed to open the file. |
| FileOpenError | 15 | Failed to read the file. |
| FileStatError | 16 | Failed to get the file status. |
| getTimeError | 17 | Failed to get the time from the log content. |
| HandleEventError | 18 | Exceptions occurred in processing the file. |
| handleFileCreateError | 19 | Exceptions occurred in `handleFileCreateEvent()`. |
| LineParseError | 20 | Failed to parse the log directory. |
| Lz4CompressError | 21 | Failed to compress. |
| readEventException | 22 | Failed to read. |
| ReadFileBugOn | 23 | A bug exists. |
| ReadFileException | 24 | Exceptions occurred in the read file. |
| ReadFileInodeChange | 25 | File node changed. |
| ReadFileTruncate | 26 | The read file is truncated. |
| WildCardPathException | 27 | Exceptions occurred in `addWildcardPathInotify()`.  |


### LogListener collection logs
The parameters of the log topic `loglistener_business` are detailed as follows:

<table>
	<tr><th>Parameter</th><th>Description</th></tr>
	<tr><td>InstanceId</td><td>LogListener unique identifier</td></tr>
	<tr><td>Label</td><td>An array of machine IDs</td></tr>
	<tr><td>IP</td><td>Machine group IP</td></tr
	<tr><td>Version</td><td>LogListener version</td></tr>
	<tr><td>TopicId</td><td>The target topic of the collected file</td></tr>
	<tr><td>FileName</td><td>File path name</td></tr>
	<tr><td>FileName</td><td>Actual file path</td></tr>
	<tr><td>FileInode</td><td>File node</td></tr>
	<tr><td>FileSize</td><td>File size</td></tr>
	<tr><td>LastReadTime</td><td>The most recent read time of the file</td></tr>
	<tr><td>ParseFailLines</td><td>Number of parsing-failed logs within a time window</td></tr>
	<tr><td>ParseFailSize</td><td>Size of parsing-failed logs within a time window</td></tr>
	<tr><td>ParseSuccessLines</td><td>Number of logs successful parsed within a time window</td></tr>
	<tr><td>ParseSuccessSize</td><td>Size of logs successful parsed within a time window</td></tr>
	<tr><td>ReadOffset</td><td>Offset of file reading in bytes</td></tr>
	<tr><td>TruncateSize</td><td>Size of truncated log files within a time window</td></tr>
	<tr><td>ReadAvgDelay</td><td>Average time delay for reads within a time window</td></tr>
	<tr><td>TimeFormatFailuresLines</td><td>Number of timestamp matching errors within a time window</td></tr>
	<tr><td>SendSuccessSize</td><td>Size of logs successful sent within a time window</td></tr>
	<tr><td>SendSuccessCount</td><td>Number of logs successful sent within a time window</td></tr>
	<tr><td>SendFailureSize</td><td>Size of sending-failed logs within a time window</td></tr>
	<tr><td>SendFailureCount</td><td>Number of sending-failed logs within a time window</td></tr>
	<tr><td>SendTimeoutSize</td><td>Size of logs with sending timed out within a time window</td></tr>
	<tr><td>SendTimeoutCount</td><td>Number of logs with sending timed out within a time window</td></tr>
	<tr><td>DroppedLogSize</td><td>Size of dropped logs within a time window</td></tr>
	<tr><td>DroppedLogCount</td><td>Number of dropped logs in a time window</td></tr>
	<tr><td>ProcessBlock</td><td>Whether the current file has triggered collection blocking in a statistical period (collection blocking will be triggered if the sliding window of a file has not moved for 10 minutes)</td></tr>
</table>

