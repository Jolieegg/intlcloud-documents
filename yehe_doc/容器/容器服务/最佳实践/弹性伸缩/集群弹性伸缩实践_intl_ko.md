Tencent Kubernetes Engine(TKE)은 클러스터 및 서비스 수준에서 탄력적인 확장성을 제공합니다. CPU, 메모리, 대역폭을 포함한 컨테이너의 메트릭을 모니터링하고 오토 스케일링을 수행할 수 있습니다. 동시에 컨테이너에 리소스가 충분하지 않거나 필요한 것보다 많은 리소스가 있는 경우 클러스터를 자동으로 스케일링할 수 있습니다. 아래 이미지를 참고하십시오.
![](https://main.qcloudimg.com/raw/43e9c790508dbba6e3db7b3a7b2c27c1.png)

### 클러스터 오토 스케일링 기능
TKE를 사용하면 사용자가 클러스터에 대한 오토 스케일링을 활성화하여 컴퓨팅 리소스를 효율적으로 관리할 수 있습니다. 사용자는 필요에 따라 스케일링 정책을 설정할 수 있습니다. Cluster 오토 스케일링에는 다음과 같은 기능이 있습니다.
 - Cluster 오토 스케일링은 프로젝트 부하 상황에 따라 실시간으로 CVM(Cloud Virtual Machines)을 동적으로 자동 생성 및 해제하여 사용자가 최적의 인스턴스 수로 프로젝트 상황에 대처할 수 있도록 도와줍니다. 전체 프로세스에서 사람의 개입이 필요하지 않으므로 사용자가 수동 배포에서 벗어날 수 있습니다.
 - Cluster 오토 스케일링은 사용자가 최적의 노드 리소스 양으로 프로젝트 상황을 처리하는 데 도움이 될 수 있습니다. 더 많은 요구 사항이 있는 경우 컨테이너 클러스터에 CVM을 원활하고 자동으로 추가합니다. 요구 사항이 적으면 불필요한 CVM을 자동으로 제거하여 장치 활용도를 높이고 배포 및 인스턴스 비용을 줄입니다.


### 클러스터 오토 스케일링 기능 설명
#### Kubernetes cluster autoscaling의 기본 기능
- 여러 스케일링 그룹 설정을 지원합니다.
- 스케일 인 및 스케일 아웃 정책 설정을 지원합니다. 자세한 내용은 [Cluster Autoscaler](https://github.com/kubernetes/autoscaler/tree/master/cluster-autoscaler)를 참고하십시오.

#### 고급 TKE 스케일링 그룹 기능
- 스케일링 그룹을 생성하는 동안 사용자 지정 모델 사용을 지원합니다(권장).
- 스케일링 그룹을 생성하는 동안 클러스터의 노드를 템플릿으로 사용할 수 있습니다.
- 스케일링 그룹에 스팟 인스턴스 추가를 지원합니다(권장).
- 모델이 품절되면 적절한 스케일링 그룹을 자동으로 매칭 지원합니다.
- 가용존에서 스케일링 그룹 설정을 지원합니다.

### 클러스터 오토 스케일링 제한 사항
- 클러스터 오토 스케일링으로 추가할 수 있는 노드 수는 VPC, 컨테이너 네트워크, TKE 클러스터 노드 할당량, 구매할 수 있는 CVM 할당량에 따라 제한됩니다.
- 노드 확장 가능 여부는 사용하려는 모델 지속 사용 가능 여부에 따라 다릅니다. 모델이 매진되면 노드를 확장할 수 없습니다. 여러 스케일링 그룹을 구성하는 것이 좋습니다.
- 워크로드에서 컨테이너의 request 값을 설정해야 합니다. request 값으로 클러스터의 리소스가 충분한지 평가하여 자동 확장을 트리거할지 여부를 결정할 수 있습니다.
- 노드의 메트릭 기반 오토 스케일링 모니터링을 활성화하지 않는 것이 좋습니다.
- 조정 그룹을 삭제하면 해당 그룹의 CVM 인스턴스도 종료됩니다. 이 때 주의하시기 바랍니다.

### 클러스터 스케일링 그룹 설정
- 여러 스케일링 그룹 설정(권장)
클러스터에 여러 개의 스케일링 그룹이 있는 경우 오토 스케일링 구성 요소는 선택한 스케일링 알고리즘에 따라 스케일 아웃할 스케일링 그룹을 선택합니다. 구성 요소는 매번 하나의 스케일링 그룹만 선택합니다. CVM 모델 품절 등의 사유로 타깃 스케일링 그룹을 스케일 아웃하지 못한 경우, 스케일링 그룹은 일정 시간 휴면 상태가 됩니다. 동시에 두 번째 일치하는 스케일링 그룹이 스케일 아웃을 위해 선택됩니다.
 - Random: 스케일 아웃을 위한 임의의 스케일링 그룹을 선택합니다.
 - Most-Pods: pending 중인 Pod 및 스케일링 그룹에 대해 선택한 모델을 기반으로 가장 많은 Pod를 스케쥴링할 수 있는 스케일링 그룹을 선택합니다.
 - Least-waste: pending 중인 Pod 및 확장 그룹에 대해 선택한 모델을 기반으로 Pod 스케쥴링 후 남은 리소스를 최소화할 수 있는 스케일링 그룹을 선택합니다.
 
 모델 품절로 인한 스케일링 실패를 방지하기 위해 클러스터에 다른 모델로 여러 개의 스케일링 그룹을 구성하는 것이 좋습니다. 동시에 스팟 인스턴스와 일반 인스턴스의 조합을 사용하여 비용을 절감할 수 있습니다.
- 단일 스케일링 그룹 구성
클러스터 확장에 하나의 특정 모델만 사용하려는 경우 확장 그룹을 여러 서브넷 및 가용존으로 구성하는 것이 좋습니다.

